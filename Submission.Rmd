---
title             : "Job Demands-Resources model components through the lens of O*NET classifications"
shorttitle        : "O*NET JD-R"

author: 
  - name          : "Alicia Stachowski"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "Menomenie, WI"
    email         : "stachowskia@uwstout.edu"
  - name          : "John Kulas"
    affiliation   : "2"
  - name          : "Renata Garcia Prieto Palacios Roji"
    affiliation   : "3"

affiliation:
  - id            : "1"
    institution   : "University of Wisconsin - Stout"
  - id            : "2"
    institution   : "eRg"
  - id            : "3"
    institution   : "PepsiCo"

abstract: |
  O\*NET work characteristics were rated in terms of relevance, perception as a demand, and perception as a resource. All the results of this current study match the stress-appraisal stuff. Next steps: 1) discuss results within stress-appraisal framework [@lazarus1984stress], 2) different literature on challenge and hindrance demands. Job Demands Resources theory that says resources and demands are relatively universal is NOT consistent with these findings. JDR neglects the other 2 literatures. Analytically pull O*Net descriptors that reflect universal demands/resources (e.g., autonomy) and see how much variability there is on those. Maybe forget about cross-walk thing. May actually want to start with this: https://docs.google.com/spreadsheets/d/1ck-72dQ_c-Pl4Xba9W0r__OYo0znlEnV/edit#gid=1041061499.[^foot1]
  
  We want to also group items by O\*NET categories so there's not so many (that makes ANOVAs more viable)
  
keywords          : "keywords"
wordcount         : "X"

bibliography      : ["r-references.bib", "jdr.bib", "jobdemands_resources_bibtex.bib"]

floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : no
mask              : no
draft             : no

csl               : apa7.csl
documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}
library("papaja")
r_refs("r-references.bib")
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed, echo=FALSE, warning=FALSE, message=FALSE)
```

Research on the job demands-resources model [@demerouti2001job] and later job demands-resources theory [@bakker2017job] highlight the importance of work characteristics on the experience of motivation and strain, which subsequently have an impact on job performance. However, much of our existing knowledge of the way this model functions is grounded in the assumption that characteristics are generally considered resources or generally considered demands. We build on the research of a small, but growing number of researchers who argue that the characteristics of work may be appraised simultaneously as resources and demands [@webster2011extending] or that appraisals may change over time [@rosen2020challenges]. We extend this critical research to that of the subjective distinction between challenge and hindrance demands (and resource) in the workplace, which a primary aims of exploring 1) whether there is variability in subjective ratings of job characteristics with respect to how much they serve as resources and demands, and 2) whether or not there is a match between the literature-implicated resources/demands and subjective ratings of these characteristics. Prior to presenting the current study in detail, we provide a brief overview of the relevant theories and relevant empirical work on this topic. 

## The Job demands-Resources Theory  

The overarching context for this study is that of the job demands-resources theory, which is an expansion of the well-studied job demands-resources model [@demerouti2001job]. One of the major advantages of the job demands-resources theory is that it allows us to model both work environment and job characteristics via job resources and demands. *Resources* include physical, psychological, social, or organizational aspects of the job that may help an employee achieve work goals, reduce job demands, or promote personal growth and development [@demerouti2001job]. In contrast, demands include components of a job that require sustained effort, and as such, produce psychological or physiological strain [e.g., high work pressure is frequently cited as a common demand; @demerouti2001job]. Cognitively, the perception of an element of one’s job as a resource or demand activates one of two distinct processes: either health impairment (resulting from demands) or motivation (resulting from resources) [@bakker2014job]. Of particular importance here is that it is the perception of a characteristic or situation determines which process an employee will experience depsite the typical apriori assignment of a characteristic as objectively a "demand" or "resource". We explore this further below.

## The Essential Role of Appraisal  

As described in the last paragraph, job context and characteristics are assigned or appraised as demands or resources. Although much of our research on job demands in particular is based on apriori classifications of demands [@searle2015merits], the classification of a work characteristic as a demand or resource is largely subjective by nature (e.g., an employee could most certainly perceive being a public figure as a resource or as a demand. The stress process speaks to how such individual difference in appraisal is possible. @lazarus1984stress presented the transactional theory of stress and coping, which states that people cognitively appraise stimuli in their environments on a continuous basis. Via this process, meaning is assigned to stimuli based on potential for gain or loss. If appraised as threatening, challenging, or possibly harmful, the resulting emotional distress initiates coping. The cycle of appraisal then continues based on the action to cope with the stressor [@lazarus1984stress]. Coping is considered a secondary appraisal and is the way that someone chooses to manage a stressor should an event or situation be deemed so. Although not suggested by the names, primary and secondary appraisals can happen simultaneously. For instance, available resources to cope with a stressor may influence an employee’s initial appraisal of a stressor (e.g., amount of time [resource] available to prepare for the speech may influence one’s primary appraisal of this ask). 
  
## The Challenge-hindrance Stressor Framework  

Although there is a tendency to attach a negative connotation to the word “stress”, @selye1936syndrome defined stress as a response to change, which is quite non-specific. We return to the employed public figure for this next section. It is quite probable that two employees would be called upon to serve as a spokesperson for their organization in a time of need. One may appraise the circumstance as an opportunity to positively influence others, while the other may plausibly feel paralyzed by the task. In fact, @bakker2017job call attention to different types of demands in their recent review of, and future directions, for work on the job-demands resources theory. 

The challenge-hindrance stressor framework suggests that the way we understand reactions to stressors requires consideration of how people feel about a given stressor [@cavanaugh2000empirical]. @cavanaugh2000empirical delineated between two forms of demands – that of *challenge* and *hindrance* demands. Challenge demands promote mastery, personal growth, and future gains – these stressors should lead to coping strategies that facilitate achievement. Stressors like time pressure and responsibility are considered challenge stressors/demands. Hindrance demands, in contrast, inhibit growth, learning and goal achievement. Hindrance stressors (e.g., role conflict, role ambiguity, politics) are associated with negative job behaviors and attitudes. This distinction between challenges and hindrances has been of value in determining which demands are related to various outcomes. The original work on this topic suggests that challenge stressors are typically associated with positive outcomes and hindrance stressors are associated with negative outcomes [e.g., @cavanaugh2000empirical]. 

Prior to considering the subsequent empirical work done on this topic, it is of value to explore *why* there is expected to be different outcomes associated with these forms of demands. @lepine2022challenge explain the mechanisms by which demands are related to performance and wellbeing outcomes. Similar to the job-demands resources theory [@bakker2017job], challenge and hindrance demands elicit two different paths or processes. First, challenge stressors typically result in a challenge appraisal, and engagement is likely to happen as a result. Engagement, in turn, is positively related to motivation, performance, growth, and wellbeing. The other side of the coin is that this energy may be depleted eventually, leading to strain. Hindrance stressors elicit a different process. Disengagement is likely to result from a hindrance appraisal, which in contrast, negatively impacts motivation, performance, growth and wellbeing. This happens because resources are depleted via frustrations and other affectively negative reactions [@lepine2022challenge]. 
 	
We next consider the empirical evidence on this topic. The broadest, and perhaps first question, we should ask is whether people perceive demands as challenges vs. hindrances, or whether all demands are under a larger “demands” category. Evidence suggests the employees do, in fact, distinguish between challenge and hindrance stressors [e.g., @bakker2013weekly; @gerich2017relevance; @webster2011extending]. For example, @bakker2013weekly found that perceived work pressure as a hindrance demand, and emotional demands as more of a challenge demand. @webster2011extending approached this question with three common workplace demands: workload, role ambiguity, and role conflict. They found while that each could be appraised primarily as challenges or hindrances demands, they could also simultaneously be perceived as being both a challenge and hindrance to different degrees. @kim2020thriving found that appraising a demand (in their study, workload, responsibility, and learning demands were measured) as a challenge was associated with motivational resources (i.e., sense of self-worth and work meaningfulness), which were positively related to flourishing. The opposite occurred when a demand was appraised as a hindrance – in those instances, the appraisal had a negative association with motivational resources.
  
Having evidence that people can make a distinction between challenge and hindrance stressors, the next logical question is whether they do relate differentially to outcomes. The challenge-hindrance stressor framework has, in fact, been associated with a wide variety of organizational outcomes ranging from affective variables like job satisfaction, to motivation, performance, and wellbeing. A sampling of variables and relationships are described below to provide a sense of scope of the work that has been on this topic. For example, @cavanaugh2000empirical, in a study of managers, found that challenge demands were positively related to job satisfaction and negatively related to job search behaviors, while hindrance demands demonstrated the opposite pattern. @chen2021daily found that daily challenge demands were positively related to cognitive wellbeing and work-family enrichment. Daily hindrance demands were negatively related to these outcomes. In contrast, @abbas2019challenge found that challenge and hindrance stressors were *both* positively related to strain and turnover intentions. We also have some evidence that challenge-hindrance appraisals are related to engagement in the expected direction whereby hindrance appraisals are negatively associated with engagement and challenge appraisals are positively associated with it [@crawford2010linking]. Challenge and hindrance appraisals have also been shown to relate to citizenship and counterproductive performance, although indirectly via emotions like anxiety [@rodell2009can]. Lastly, @gerich2017relevance concluded that employee wellbeing was also, in part, explained by appraised challenge or hindrance demands such that working conditions of time pressure, qualitative demands, responsibility, and interruptions, were partially mediated by challenge and hindrance demands. 

We even have sufficient evidence to explore outcomes associated with challenge and hindrance stressors meta-analytically at this point, and a rich collection of them support differential associations across a variety of organizational outcomes. For example, both challenges and hindrances have been shown to positively predict strain [@lepine2005meta; @podsakoff2007differential; @webster2010toward]. Many other outcomes are differentially related to challenges and hindrances, largely in the expected direction. For example, motivation, job satisfaction, commitment, and performance have been shown to positively relate to challenge stressors and negatively relate to hindrance stressor [@lepine2005meta]. Turnover intentions, turnover and withdrawal behaviors are negatively related to hindrance stressors [@podsakoff2007differential]. @kim2020thriving, similarly, found evidence for the differential results via challenge and hindrance appraisals.  

@horan2020review and @lepine2022challenge specifically call out the need for additional research to incorporate the appraisal process described by @lazarus1984stress into the challenge-hindrance stressor framework, which aligns with other calls to capture subjective ratings of demands and resources into our study of the overarching JD-R model. In fact, @horan2020review state that “…stressors are only challenge or hindrance stressors to the extent that they are perceived as such by employees” (p. 3). In fact, @horan2020review suggest future research continue to move away from apriori classifications of stressors, as doing so can be problematic for theoretical and empirical reasons. Theoretically, apriori classifications run counter to the original transactional theory of stress on which the challenge-hindrance stressor framework was based for which appraisals are a central component. Empirically, as shown above, we have some evidence suggesting people can appraise a stressor as both a hindrance and challenge at the same time [e.g., @searle2015merits]. THE TRANSITION NEEDED HERE COULD ADDRESS RENATA'S RECOMMENDATION TO TIE THIS LITERATURE BACK INTO THE JOB-DEMANDS RESOURCES MODEL. 

## O\*Net Resource  

Originally, the Advisory Panel for the Dictionary of Occupational Titles recommended a system that would “…promote the effective education, training, counseling, and employment of the American workforce. It should accomplish its purpose by providing a database system that identifies, defines, classifies, and describes occupations in the economy in an accessible and flexible manner” [@advisory1993new, p. 6]. The result was the now commonly used O\*NET. The Occupational Information Network (O\*NET; onetonline.org) contains a comprehensive description of occupations [@peterson2001understanding]. This widely accessed database houses hundreds of standardized and occupation-specific descriptors most occupations in the US and these descriptions are continually updated. In fact, there was a call to work with experienced I/O psychologists over the summer to update the content for the [Industrial and Organizational Psychologist listing on O\*Net](https://www.onetonline.org/link/summary/19-3032.00). These data, and the tools provided for free on the website (e.g., Career Exploration Tools, “My Next Move for Veterans”, “My Next Move”, Toolkit for Business) are frequently used by counselors, students, human resources departments, and researchers to assist potential applicants discover the skills and training they need for the job of their choice. It is also useful to employers by providing them with information with which to craft job descriptions and help employees determine what skills are needed for promotion. 

## Current Study and Hypotheses

Of greatest interest here are statements taken from O\*NET ["activity" and "context" classifications](https://www.O\*NETonline.org/find/descriptor/result/4.A.1.b.3) (e.g., items related to information input, interacting with others, physical work conditions, structural job characteristics). One of the first and basic questions is whether or not the categorical examples of "resources" and "demands" described in the Job Demands-Resources Theory [@demerouti2001job], for example, are generally deemed resources or demands as we objectively define them. The next logical question surrounds how "universal" such ratings are. For instance, it is quite possible, given the theoretical and empirical evidence presented above, that there is wide variability in individual appraisal of work activities and context such that some people may rate a given activity as a resource and others a hindrance. 

>Hypothesis 1: Job characteristics differ in variability/stability regarding subjective worker perception as a demand or resource.

>Hypothesis 2: Job characteristics are not uniquely categorized as a resource or demand, but rather, some job characteristics are rated highly as both a resource and a demand.

Lastly, we propose three research that explicitly address a topic hinted at in the literature review above. Although challenge stressors tend to be appraised more so as challenges, and hindrance stressors tend to be appraised more as hindrances than challenges, there remains variability in these appraisals [@lepine2022challenge]. @lepine2022challenge, in fact, argues that the challenge-hindrance stressor framework acknowledges that these appraisals are not universal. We explore whether literature-implicated job characteristics (e.g., autonomy) are consistently rated as our research models suggest across the job-demands resources theory [@bakker2017job]and challenge-hindrance stressor framework [@cavanaugh2000empirical].

>*Research Question 1*: Are literature-implicated resources consistently rated as job resources?

>*Research Question 2*: Are literature-implicated challenges consistently rated as job challenges?

>*Research Question 3*: Are literature-implicated hiderances consistently rated as job hindrances?

```{r study1}

temp <- read.csv("initial_data_screen.csv", header=FALSE, na.strings="")   ## NOTE: 404 vars (9/28/21) make sure to check indexing used throughout script

x <- paste("item", sep="",1:404)
y <- t(temp[2,])
                                        ## decluttering Qualtrics excess
data <- temp[-c(1:3),]                                           ## Getting rid of all 3 weird Qualtrics rows
colnames(data) <- x

incomplete <- read.csv("inprogress.csv", header=FALSE, na.strings="")   ## NOTE: 404 vars (9/28/21) make sure to check indexing used throughout script

data2 <- incomplete[-c(1:2),-c(10,12,16,113,199,285,371,379,400, 406:411)]                                          

data3 <- as.data.frame(cbind(data2$V8,data2$V9,data2$V1,data2$V1,data2$V1,data2$V1,data2$V1,data2$V1,data2))

colnames(data3) <- x

rm(x, y, temp)       

use <- rbind(data,data3)

## STILL NEED FILE WITH BAD RESPONDENTS IDENTIFIED (E.G., Item_18=2, na > 200, longstring > 20, CARELESS CHECKS > 1)

library(careless)
use$careless_long <- longstring(use[18:399])
use$missing <- rowSums(is.na(use[18:404])) 

different <- use[ which(use$item18 == 2 | use$careless_long > 20 | use$missing > 200), ]

attention <- use[which(use$item61 == 5 & use$item145 == 5 & use$item248 == 2 & use$item308 == 3), ]

data <- data.frame(lapply(attention, function(x) as.numeric(as.character(x))))
data <- data[,c(1:404)]

numtot <- nrow(use)
numkicked <- nrow(different)
numvalid <- nrow(data)

```

```{r demos}

a <- descr::freq(use$item401, plot=FALSE)

use$item402[use$item402 == "Female " | use$item402 == "female" | use$item402 == "FEMALE" | use$item402 == "Woman" | use$item402 == "Mujer" | use$item402 == "feminine" | use$item402 == "fEMALE" | use$item402 == "F" | use$item402 == "Femenale" | use$item402 == "feminino" | use$item402 == "female " | use$item402 == "Fem" | use$item402 == "Feminine" | use$item402 == "feminine" | use$item402 == "WOMAN" | use$item402 == "Femal" | use$item402 == "femenine" | use$item402 == "Femenine" | use$item402 == "femenino" | use$item402 == "woman"]  <- "Female"

use$item402[use$item402 == "gerente" | use$item402 == "M" | use$item402 == "Make" | use$item402 == "Mal" | use$item402 == "male" | use$item402 == "MALE" | use$item402 == "male" | use$item402 == "Male" | use$item402 == "mals" | use$item402 == "man" | use$item402 == "masculine" | use$item402 == "Masculine" | use$item402 == "Man" | use$item402 == "mals " | use$item402 == "male " | use$item402 == "Male "]  <- "Male"

b <- descr::freq(use$item402, plot=FALSE)

##Job title
library(labourR)


#ESCO/ISCO classification using the labourR package
#ISCO = International Standard Classification of Occupations

attention$id <- 1:nrow(attention) #adds unique identifier to satisfy inane requirement of classify_occupation()

ISCO <- classify_occupation(attention, text_col = 'item400', isco_level = 1) 

m3 <-merge(attention, ISCO, by.x = "id", by.y = "id", all.x = TRUE)

c <- descr::freq(m3$preferredLabel, plot=FALSE)

knowledge <- data[ which(m3$iscoGroup == "1" | m3$iscoGroup == "2"), ]
service <- data[ which(m3$iscoGroup == "3" | m3$iscoGroup == "4" | m3$iscoGroup == "5" | m3$iscoGroup == "6" | m3$iscoGroup == "7" | m3$iscoGroup == "8" | m3$iscoGroup == "9"), ]

data$item403[data$item403 == 2000]  <- 20

```


```{r generalrecodes, include=FALSE}

source("recodescript.R", local = knitr::knit_global())

```

# Method
 
Data were collected through Prolific, a data collection platform. An email was sent to a random subset of all eligible participants in the Prolific respondent pool, notifying them about their eligibility for the study based on demographic information. Eligibility requirements included being 18+ and holding either a full-time or part-time job. Participants then voluntarily chose to respond to the survey. The survey was conducted online via Qualtrics with an estimated completion time of 40-45 minutes. Participants were asked to think about their primary job while answering the survey, and the items they were presented with depended on the specific job characteristics they initially specified. Thus, if a respondent indicated that a characteristic was not part of their job, they were not subsequently asked to rate the level of resource, challenge, or hindrance for that characteristic. For characteristics that *were* implicated as being relevent for their job, they were then asked to report how much a characteristic was a resource, and then how much each characteristic was a hindrance, and finally, how much each item was a challenge. Participants were compensated for their participation in this study in the amount of six dollars through Prolific.

## Participants

Of the `r nrow(use)` Prolific panel individuals who initially accessed the survey link, `r nrow(different)` indicated that they were not interested, had more than 200 missing responses, or had 20 or more identical consecutive sequential responses [@R-careless]. Applying a further screen regarding attention checks (there were four attention checks embedded throughout, asking respondents to indicate a specific answer) resulted in the retention of `r nrow(data)` respondents who constitute the current sample. Regarding tenure, `r round(a[1,3],2)`% had been in their referent job less than 6 months, `r round(a[2,3],1)`% between 6 months and a year, `r round(a[3,3],2)`% between one and five years, `r round(a[4,3],2)`% between 5 and 10 years, and `r round(a[5,3],2)`% more than 10 years. Respondent ages ranged from 18 to 65 with an average of `r round(mean(data[,403], na.rm=TRUE),2)` years old (*SD* = `r round(sd(data[,403], na.rm=TRUE),2)`). The survey offered a free-field gender identity category, although the sample predominantly self-identified as female (`r round(b[2,3],2)`%) or male (`r round(b[5,3],2)`%). 

```{r litresources, fig.cap="Average and standard deviation of O*Net characteristics retained as indicators of Autonomy, Cohesion, Control, Participation, and Supervisor Support."}

###############################################
###############################################


labels <- read.csv("truncatedlabels.csv")            

resource <- as.data.frame(t(data[118:202]))           

resource$description <- labels[c(118:202),1]
resource$mean <- round(rowMeans(resource[1:nrow(data)], na.rm=TRUE),2)
resource$sd   <- round(apply(resource[1:nrow(data)], 1, sd, na.rm=TRUE),2)

resource <- resource[,-145]   ## attention check
#resource <- resource[ which(resource$sd > 0), ] 

resource.control <- resource[ which(resource$description=='job structured for you, rather than allowing you to determine tasks, priorities, and goals' | resource$description=='regular work schedules'), ]
resource.control$category <- "Control"

resource.participation <- resource[ which(resource$description=='responsible for work outcomes and results of other workers' | resource$description=='responsibility for the health and safety of others' | resource$description=='developing specific goals and plans to prioritize, organize, and accomplish your work' | resource$description=='scheduling events, programs, and activities, as well as the work of others' | resource$description=='developing, designing, or creating new applications, ideas, relationships, systems, or products' | resource$description=='providing information to supervisors, co-workers, and subordinates by telephone, in written form, e-mail, or in person'), ]
resource.participation$category <- "Participation"

resource.sup.support <- resource[ which(resource$description=='providing guidance and expert advice to management or other groups on technical, systems-, or process-related topics' | resource$description=='identifying the educational needs of others, developing formal educational or training programs or classes, and teaching or instructing others'), ]
resource.sup.support$category <- "Support"

resource.autonomy <- resource[ which(resource$description=='decision making freedom, without supervision'), ]
resource.autonomy$category <- "Autonomy"

resource.cohesion <- resource[ which(resource$description=='work with others in a group or team' | resource$description=='getting members of a group to work together to accomplish tasks' | resource$description=='' | resource$description=='' | resource$description=='' | resource$description=='encouraging and building mutual trust, respect, and cooperation among team members'), ]
resource.cohesion$category <- "Cohesion"

notedresource <- rbind(resource.control, resource.participation, resource.sup.support, resource.autonomy, resource.cohesion)
notedresource$RD <- "Resource"


#########################################################
#########################################################


challenge <- as.data.frame(t(data[288:372]))           

challenge$description <- labels[c(288:372),1]
challenge$mean <- round(rowMeans(challenge[1:nrow(data)], na.rm=TRUE),2)
challenge$sd   <- round(apply(challenge[1:nrow(data)], 1, sd, na.rm=TRUE),2)


challenge <- challenge[,-308]

challenge.control <- challenge[ which(challenge$description=='job structured for you, rather than allowing you to determine tasks, priorities, and goals' | challenge$description=='regular work schedules'), ]
challenge.control$category <- "Control"

challenge.participation <- challenge[ which(challenge$description=='responsible for work outcomes and results of other workers' | challenge$description=='responsibility for the health and safety of others' | challenge$description=='developing specific goals and plans to prioritize, organize, and accomplish your work' | challenge$description=='scheduling events, programs, and activities, as well as the work of others' | challenge$description=='developing, designing, or creating new applications, ideas, relationships, systems, or products' | challenge$description=='providing information to supervisors, co-workers, and subordinates by telephone, in written form, e-mail, or in person'), ]
challenge.participation$category <- "Participation"

challenge.sup.support <- challenge[ which(challenge$description=='providing guidance and expert advice to management or other groups on technical, systems-, or process-related topics' | challenge$description=='identifying the educational needs of others, developing formal educational or training programs or classes, and teaching or instructing others'), ]
challenge.sup.support$category <- "Support"

#challenge.autonomy <- challenge[ which(challenge$description=='decision making freedom, without supervision'), ]
#challenge.autonomy$category <- "Autonomy"

challenge.cohesion <- challenge[ which(challenge$description=='work with others in a group or team' | challenge$description=='getting members of a group to work together to accomplish tasks' | challenge$description=='' | challenge$description=='' | challenge$description=='' | challenge$description=='encouraging and building mutual trust, respect, and cooperation among team members'), ]
challenge.cohesion$category <- "Cohesion"

notedchallenge <- rbind(challenge.control, challenge.participation, challenge.sup.support,  challenge.cohesion)     ## removed challenge.autonomy 8/24/22
notedchallenge$RD <- "Challenge"

############################################################
############################################################


hindrance <- as.data.frame(t(data[203:287]))           

hindrance$description <- labels[c(203:287),1]
hindrance$mean <- round(rowMeans(hindrance[1:nrow(data)], na.rm=TRUE),2)
hindrance$sd   <- round(apply(hindrance[1:nrow(data)], 1, sd, na.rm=TRUE),2)

hindrance <- hindrance[,-248]   ## attention check
#hindrance <- hindrance[ which(hindrance$sd > 0), ] 

hindrance.control <- hindrance[ which(hindrance$description=='job structured for you, rather than allowing you to determine tasks, priorities, and goals' | hindrance$description=='regular work schedules'), ]
hindrance.control$category <- "Control"

hindrance.participation <- hindrance[ which(hindrance$description=='responsible for work outcomes and results of other workers' | hindrance$description=='responsibility for the health and safety of others' | hindrance$description=='developing specific goals and plans to prioritize, organize, and accomplish your work' | hindrance$description=='scheduling events, programs, and activities, as well as the work of others' | hindrance$description=='developing, designing, or creating new applications, ideas, relationships, systems, or products' | hindrance$description=='providing information to supervisors, co-workers, and subordinates by telephone, in written form, e-mail, or in person'), ]
hindrance.participation$category <- "Participation"

hindrance.sup.support <- hindrance[ which(hindrance$description=='providing guidance and expert advice to management or other groups on technical, systems-, or process-related topics' | hindrance$description=='identifying the educational needs of others, developing formal educational or training programs or classes, and teaching or instructing others'), ]
hindrance.sup.support$category <- "Support"

hindrance.autonomy <- hindrance[ which(hindrance$description=='decision making freedom, without supervision'), ]
hindrance.autonomy$category <- "Autonomy"

hindrance.cohesion <- hindrance[ which(hindrance$description=='work with others in a group or team' | hindrance$description=='getting members of a group to work together to accomplish tasks' | hindrance$description=='' | hindrance$description=='' | hindrance$description=='' | hindrance$description=='encouraging and building mutual trust, respect, and cooperation among team members'), ]
hindrance.cohesion$category <- "Cohesion"

notedhindrance <- rbind(hindrance.control, hindrance.participation, hindrance.sup.support, hindrance.autonomy, hindrance.cohesion)
notedhindrance$RD <- "Hindrance"

###########################################################
###########################################################  Name issue somehow above 

labels <- names(notedresource)
colnames(notedchallenge) <- labels
colnames(notedhindrance) <- labels

together <- rbind(notedchallenge,notedhindrance,notedresource)

############################################################
############################################################

library(ggplot2)
library(dplyr)

summarized <- together %>%                               # Summary by group using dplyr
  group_by(category, RD) %>% 
  summarize(mean = mean(mean),
            sd = mean(sd))

summarized$RD <- factor(summarized$RD, levels = c("Resource", "Challenge", "Hindrance"))

ggplot(summarized, aes(x=category, y=mean, fill=RD)) + geom_bar(stat="identity", position=position_dodge()) + theme_bw() + xlab("") + ylab("Average Job Characteristic Rating") + coord_cartesian(ylim=c(1,5)) + scale_fill_brewer(palette="Blues") + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.5, size=0.8, position=position_dodge(.9))

```

## Materials

Our survey was informed by 98 statements taken from job characteristic descriptors located within O\*Net’s classification of “work activities”: 1) Information Input (5 statements), 2) Interacting with Others (17 statements), 3) Mental Processes (10 statements), and 4) Work Output (9 statements) and “work context” groupings: 1) Interpersonal Relationships (14 statements), 2) Physical Work Conditions (30 statements), and 3) Structural Job Characteristics (13 statements).
  
The O\*Net descriptors are written in a similar manner to a task statement presented within a job analysis, but the level of abstraction is closer to "responsibility" than task. For example, the descriptor for "level of competition", which is an element of the "structural job characteristics" grouping, is *...to what extent does this job require the worker to compete or to be aware of competitive pressures?* Other than minor grammatical editing (for example, changing “the worker” to “you”), we retained the O\*Net wording for our item stems. We also retained O\*Net’s response scales, several of which were semantically unique across items, but all shared the same 5-point scale. It would likely NOT be considered controversial to referred to these as "effectively" Likert-type response scales. 

The total number of items on the survey was less than 392 (98 characteristics x 4 administrations) because we did not ask for demand and resource evaluations for 14 O\*Net characteristics that we projected would have very low frequency of endorsement across respondents (one excluded characteristic, for example, was *...the extent to which the worker is exposed to radiation on the job*). 

We used 98 statements taken from O\*NET [activity and context classifications](https://www.ONETonline.org/find/descriptor/result/4.A.1.b.3). We retained 41 work activity classifications which O\*NET groups into categories of information input (5 statements), interacting with others (17 statements), mental processes (10 statements) and work output (9 statements). Fifty-seven work context statements grouped into interpersonal relationships (14 statements), physical work conditions (30 statements), and structural job characteristics (13 statements).  

These descriptors often have [unique response categories](https://www.ONETonline.org/find/descriptor/result/4.C.1.c.2). For example, the statement "How responsible is the worker for work outcomes and results of other workers?" has response options ranging from *No responsibility* to *Very high responsibility*, while the statement, "How often do you use electronic mail in this job?" has options ranging from *Never* to *Every day*. We retained the essence of each O\*NET descriptor to capture characteristics of relevance for each respondent. Subsequent to these self evaluations, each respondent who agreed that the element had *at least some relevance* to their job was also asked to rate that element in terms of, 1) ...this aspect of your job is a resource that can be functional in achieving work goals, reduce job demands, or stimulate personal growth/development, 2) ...this aspect of your job is a challenge that can promote mastery, personal growth, or future gains, and 3) ...this aspect of your job is a hindrance that can inhibit personal growth, learning, and work goal attainment. 

# Results  

Outline:

1. Hypothesis 1: Job characteristics differ in variability/stability regarding subjective worker perception as a demand or resource.

2. Hypothesis 2: Job characteristics are not uniquely categorized as a resource or demand, but rather, some job characteristics are rated highly as both a resource and a demand.

3. *Research Question 1*: Are literature-implicated resources consistently rated as job resources?

4. *Research Question 2*: Are literature-implicated challenges consistently rated as job challenges?

5. *Research Question 3*: Are literature-implicated hiderances consistently rated as job hindrances?

## Low Variability Demands and Resources

```{r resourcesagree, fig.cap="Characteristics most similarly viewed as resources (lowest standard deviations)."}

labels <- read.csv("truncatedlabels.csv")   

resource <- as.data.frame(t(data[118:202]))           

resource$description <- labels[c(118:202),1]
resource$mean <- round(rowMeans(resource[1:nrow(data)], na.rm=TRUE),2)
resource$sd   <- round(apply(resource[1:nrow(data)], 1, sd, na.rm=TRUE),2)

resource <- resource[,-145]   ## attention check
#resource <- resource[ which(resource$sd > 0), ] 
########################################################
########################################################
##Need to triple check all of this. 
########################################################
########################################################
##checking the ns
#library(psych)
#resource_ns <- describe(data[c(118:144, 146:202)])
#resource_ns
#table(data$item161) # check one item to confirm ns - it is functioning correctly.

#resource <- cbind(resource, resource_ns$n)
#resource
sortresource <- resource[order(resource$sd),]

topresource <- head(sortresource, 10)

topresource <- topresource[tail(names(topresource),3)]        

library(ggplot2)

ggplot(topresource, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="blue", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Most Agreed Upon as a Resource") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,6)) 

```

```{r ncheck}

## Use this chunk to figure out n issue - 12/16/22 w/ Alicia on Zoom

## 12/16 looks like these sd's are non-zero but graphs have zeros - triple checking should be applied to graphs prior to this chunk

resource <- resource[ which(resource$sd > 0), ] 
########################################################
########################################################
##Need to triple check all of this. 
########################################################
########################################################
##checking the ns
#library(psych)
resource_ns <- psych::describe(data[c(118:144, 146:202)])
#resource_ns
#table(data$item161) # check one item to confirm ns - it is functioning correctly.

resource <- cbind(resource, resource_ns$n)
resource


```



```{r challengesagree, fig.cap="Characteristics most similarly viewed as challenges (lowest standard deviations)."}

labels <- read.csv("truncatedlabels.csv")            

challenge <- as.data.frame(t(data[288:372]))           

challenge$description <- labels[c(288:372),1]
challenge$mean <- round(rowMeans(challenge[1:nrow(data)], na.rm=TRUE),2)
challenge$sd   <- round(apply(challenge[1:nrow(data)], 1, sd, na.rm=TRUE),2)


challenge <- challenge[,-308]   ## attention check
#challenge <- challenge[ which(challenge$sd > 0), ] 

sortchallenge <- challenge[order(challenge$sd),]

topchallenge <- head(sortchallenge, 10)

topchallenge <- topchallenge[tail(names(topchallenge),3)]        

library(ggplot2)

ggplot(topchallenge, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="yellow", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Most Agreed Upon as a Challenge") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,6)) 


```

```{r hindrancesagree, fig.cap="Characteristics most similarly viewed as hindrances (lowest standard deviations)."}

labels <- read.csv("truncatedlabels.csv")    

hindrance <- as.data.frame(t(data[203:287]))           

hindrance$description <- labels[c(203:287),1]
hindrance$mean <- round(rowMeans(hindrance[1:nrow(data)], na.rm=TRUE),2)
hindrance$sd   <- round(apply(hindrance[1:nrow(data)], 1, sd, na.rm=TRUE),2)

hindrance <- hindrance[,-248]   ## attention check
#hindrance <- hindrance[ which(hindrance$sd > 0), ] 

sorthindrance <- hindrance[order(hindrance$sd),]

tophindrance <- head(sorthindrance, 10)

tophindrance <- tophindrance[tail(names(tophindrance),3)]        

library(ggplot2)

ggplot(tophindrance, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="red", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Most Agreed upon as a Hindrance") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,5))

```

Figures \@ref(fig:resourcesagree), \@ref(fig:challengesagree), and \@ref(fig:hindrancesagree) present the resources, challenges, and hindrances that are *largely agreed on* as indexed by (relatively) low standard deviations.[^caveat]

[^caveat]: There were a few characteristics with standard deviations of "zero" but these were excluded from presenation as they were likely representing only one person (*n*'s should also go on these graphs if they're retained - Alicia's idea 12/2 was to use initial ratings as indicators of counts).

As can be seen by the graphs, there is considerable disagreement regarding the degree to which job elements are considered *hindrances*, with the 10 elements showing the greatest agreement still ranging in standard deviations from `r min(tophindrance$sd)` to `r max(tophindrance$sd)`. What is widely seen as a resource and challenge tends to be more universally agreed upon (range of lowest 10 resource standard deviations is `r min(topresource$sd)` to `r max(topresource$sd)` and the range of lowest 10 challenge standard deviations is `r min(topchallenge$sd)` to `r max(topchallenge$sd)`.

## High Variability Demands and Resources

```{r resourcesdisagree, fig.cap="Characteristics most *dis*similarly viewed as resources (highest standard deviations)."}

labels <- read.csv("truncatedlabels.csv")            

resource <- as.data.frame(t(data[118:202]))           

resource$description <- labels[c(118:202),1]
resource$mean <- round(rowMeans(resource[1:nrow(data)], na.rm=TRUE),2)
resource$sd   <- round(apply(resource[1:nrow(data)], 1, sd, na.rm=TRUE),2)

resource <- resource[,-145]   ## attention check
resource <- resource[ which(resource$sd > 0), ] 

sortresource <- resource[order(-resource$sd),]

topresource <- head(sortresource, 10)

topresource <- topresource[tail(names(topresource),3)]        

library(ggplot2)

ggplot(topresource, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="blue", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Least Agreed Upon as a Resource") + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,5)) 

```

```{r challengesdisagree, fig.cap="Characteristics most *dis*similarly viewed as challenges (highest standard deviations)."}

labels <- read.csv("truncatedlabels.csv")            

challenge <- as.data.frame(t(data[288:372]))           

challenge$description <- labels[c(288:372),1]
challenge$mean <- round(rowMeans(challenge[1:nrow(data)], na.rm=TRUE),2)
challenge$sd   <- round(apply(challenge[1:nrow(data)], 1, sd, na.rm=TRUE),2)


challenge <- challenge[,-308]   ## attention check
challenge <- challenge[ which(challenge$sd > 0), ] 

sortchallenge <- challenge[order(-challenge$sd),]

topchallenge <- head(sortchallenge, 10)

topchallenge <- topchallenge[tail(names(topchallenge),3)]        

library(ggplot2)

ggplot(topchallenge, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="yellow", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Least Agreed Upon as a Challenge") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,5)) 


```

```{r hindrancesdisagree, fig.cap="Characteristics most *dis*similarly viewed as hindrances (highest standard deviations)."}

labels <- read.csv("truncatedlabels.csv")            

hindrance <- as.data.frame(t(data[203:287]))           

hindrance$description <- labels[c(203:287),1]
hindrance$mean <- round(rowMeans(hindrance[1:nrow(data)], na.rm=TRUE),2)
hindrance$sd   <- round(apply(hindrance[1:nrow(data)], 1, sd, na.rm=TRUE),2)

hindrance <- hindrance[,-248]   ## attention check
hindrance <- hindrance[ which(hindrance$sd > 0), ] 

sorthindrance <- hindrance[order(-hindrance$sd),]

tophindrance <- head(sorthindrance, 10)

tophindrance <- tophindrance[tail(names(tophindrance),3)]        

library(ggplot2)

ggplot(tophindrance, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="red", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Least Agreed upon as a Hindrance") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,5))

```

Figures \@ref(fig:resourcesdisagree), \@ref(fig:challengesdisagree), and \@ref(fig:hindrancesdisagree) present the resources, challenges, and hindrances that are *largely disagreed on* as indexed by (relatively) high standard deviations (these are the 10 characteristics with the greatest variability in rating).

```{r scalelevelgraphs, fig.cap="Average characteristic rating grouped by literature-implicated categorizations."}

#this is a placeholder for the scale level faceted graph found in plotscript_practice script file. 
#Open the Submission .rmd
#Run chunks up to the source recodes chunk (named, `generalrecodes`), and then use the data object
#to create the ggplot

library(ggplot2)
library(plyr)
library(dplyr)

#Demands (resources ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$resources_workpressure <- rowMeans(subset(data, select = c(item120, item121)), na.rm = TRUE)
data$resources_phyworkload_wkover <- rowMeans(subset(data, select = c(item122, item137, item138,
                                                                      item139, item141, item142,
                                                                      item143)), na.rm = TRUE)
data$resources_timepressure <- rowMeans(subset(data, select = c(item125, item126)), na.rm = TRUE)
data$resources_recipientcontact <- rowMeans(subset(data, select = c(item149, item154, item157, 
                                                                    item160, item186, item188, 
                                                                    item192, item197, item200, 
                                                                    item201, item151)), na.rm = TRUE)
data$resources_phyenvironment <- rowMeans(subset(data, select = c(item128, item129,	item130, item132,
                                                                  item133,item134,	item136,	item144,	item146,
                                                                  item147,	item148,	item177,	item180,
                                                                  item182,	item181,	item183)), na.rm = TRUE)
data$resources_emotionaldemands <- rowMeans(subset(data, select = c(item150, item155, item199)), na.rm = TRUE)

#Demands (challenge ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$challenge_workpressure <- rowMeans(subset(data, select = c(item290, item291)), na.rm = TRUE)
data$challenge_phyworkload_wkover <- rowMeans(subset(data, select = c(item292, item307, 
                                                                      item309, item310,	item312,
                                                                      item313,	item314)), na.rm = TRUE)
data$challenge_timepressure <- rowMeans(subset(data, select = c(item295, item296)), na.rm = TRUE)
data$challenge_recipientcontact <- rowMeans(subset(data, select = c(item319, item324, item327,
                                                                    item330, item356, item358,
                                                                    item362, item367, item370,
                                                                    item371, item321)), na.rm = TRUE)
data$challenge_phyenvironment <- rowMeans(subset(data, select = c(item298, item299, item300, item302,
                                                                  item303, item304,item306, item315, item316,
                                                                  item317, item318, item347, item350,
                                                                  item352, item351, item353)), na.rm = TRUE)
data$challenge_emotionaldemands <- rowMeans(subset(data, select = c(item320, item325, item369)), na.rm = TRUE)

#Demands (hindrance ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$hindrance_workpressure <- rowMeans(subset(data, select = c(item205, item206)), na.rm = TRUE)
data$hindrance_phyworkload_wkover <- rowMeans(subset(data, select = c(item207, item222,item223,
                                                                      item224, item226, item227,
                                                                      item228)), na.rm = TRUE)
data$hindrance_timepressure <- rowMeans(subset(data, select = c(item210, item211)), na.rm = TRUE)
data$hindrance_recipientcontact <- rowMeans(subset(data, select = c(item233, item238, item241, 
                                                                    item244, item271, item273,
                                                                    item277,	item282,	item285,
                                                                    item286, item235)), na.rm = TRUE)
data$hindrance_phyenvironment <- rowMeans(subset(data, select = c(item213, item214, item215, item217,
                                                                  item218, item219, item221, item229,
                                                                  item230,	item231,	item232,	
                                                                  item262, item265, item267, item266,
                                                                  item286)), na.rm = TRUE)
data$hindrance_emotionaldemands <- rowMeans(subset(data, select = c(item234, item239, item284)), na.rm = TRUE)

#Resources (resource ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$resource_jobcontrol <- rowMeans(subset(data, select = c(item124, item127)), na.rm = TRUE)
data$resource_participation <- rowMeans(subset(data, select = c(item158, item159,
                                                                item172,	item174, item175,
                                                                item189, item193, item202)), na.rm = TRUE)
data$resource_teamcohesion <- rowMeans(subset(data, select = c(item161, item190, item191)), na.rm = TRUE)
data$resource_autonomy <- rowMeans(subset(data, select = c(item118, item172)), na.rm = TRUE)

#Resources (challenge ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$challenge_jobcontrol <- rowMeans(subset(data, select = c(item294, item297)), na.rm = TRUE)
data$challenge_participation <- rowMeans(subset(data, select = c(item328, item329, item342,
                                                                 item344, item345, item359, item363,
                                                                 item372)), na.rm = TRUE)
data$challenge_teamcohesion <- rowMeans(subset(data, select = c(item331, item360, item361)), na.rm = TRUE)
data$challenge_autonomy <- rowMeans(subset(data, select = c(item288, item342)), na.rm = TRUE)

#Resources (hindrance ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$hindrance_jobcontrol <- rowMeans(subset(data, select = c(item209, item212)), na.rm = TRUE)
data$hindrance_participation <- rowMeans(subset(data, select = c(item242, item243, item257,	item259,
                                                                 item260,	item274,	item278,
                                                                 item287)), na.rm = TRUE)
data$hindrance_teamcohesion <- rowMeans(subset(data, select = c(item245, item275, item276)), na.rm = TRUE)
data$hindrance_autonomy <- rowMeans(subset(data, select = c(item203, item257)), na.rm = TRUE)

#check the autonomy variables
#summary(data$hindrance_autonomy)
#summary(data$challenge_autonomy)
#summary(data$resource_autonomy)

library(tidyr)

toplot <- gather(data, scale, value, resources_workpressure:hindrance_autonomy, factor_key=TRUE)

library(stringr)
toplot$type <- str_sub(toplot$scale, 1,6)
toplot$onet <- str_sub(toplot$scale, 10,-1)

toplot$type[toplot$type == "challe"] <- "Challenge"
toplot$type[toplot$type == "hindra"] <- "Hindrance"
toplot$type[toplot$type == "resour"] <- "Resource"       ## change `onet` later if want to keep graphs

toplot$onet[toplot$onet == "teamcohesion"] <- "Team Cohesion"       
toplot$onet[toplot$onet == "_teamcohesion"] <- "Team Cohesion"  
toplot$onet[toplot$onet == "participation"] <- "Participation"       
toplot$onet[toplot$onet == "_participation"] <- "Participation"  
toplot$onet[toplot$onet == "jobcontrol"] <- "Job Control"       
toplot$onet[toplot$onet == "_jobcontrol"] <- "Job Control"  
toplot$onet[toplot$onet == "autonomy"] <- "Autonomy"       
toplot$onet[toplot$onet == "_autonomy"] <- "Autonomy"  

toplot$onet[toplot$onet == "_emotionaldemands"] <- "Emotional Demands"          ## added 11/18/22 (Hudson)  
toplot$onet[toplot$onet == "_phyenvironment"] <- "Physical Environment"  
toplot$onet[toplot$onet == "_phyworkload_wkover"] <- "Overwork"  
toplot$onet[toplot$onet == "_recipientcontact"] <- "Recipient Contact"  
toplot$onet[toplot$onet == "_timepressure"] <- "Time Pressure"  
toplot$onet[toplot$onet == "_workpressure"] <- "Work Pressure"  

toplotgg <- ddply(toplot, c("type", "onet"), summarise, average = mean(value, na.rm=TRUE))

#table(toplot$onet)

## Probably want to change this to a facet: 3 different grids grouped by literature-described 1) resource, 2) hindrances, and 3) challenge

toplotgg$facet <- c("Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand",
                    "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand",
                    "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand")


##############################################################
##############################################################
################    Plots

demandsplot <- filter(toplotgg, facet == "Lit Demand")
resourcesplot <- filter(toplotgg, facet == "Lit Resource")


## Demands

demandsplot$onet <- factor(demandsplot$onet, levels=c("Work Pressure", "Recipient Contact", "Emotional Demands", "Time Pressure", "Physical Environment", "Overwork"))

a <- ggplot(data=demandsplot, aes(x=onet, y=average, fill=type)) + 
  geom_bar(stat="identity", position=position_dodge(), color="black") + coord_flip(ylim=c(1,5)) + scale_fill_manual(values=c("#000000","#cccccc","#ffffff")) +
  scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
  theme(legend.title=element_blank(), legend.position="none",  panel.border = element_rect(colour = "black", fill=NA, size=.5), axis.title.x = element_blank(), axis.title.y = element_blank())

## Resources

resourcesplot$onet <- factor(resourcesplot$onet, levels=c("Team Cohesion", "Autonomy", "Participation", "Job Control"))

b <- ggplot(data=resourcesplot, aes(x=onet, y=average, fill=type)) + 
  geom_bar(stat="identity", position=position_dodge(), color="black") + coord_flip(ylim=c(1,5)) + scale_fill_manual(values=c("#000000","#cccccc","#ffffff")) +
  scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
  theme(legend.title=element_blank(), legend.position="bottom",  panel.border = element_rect(colour = "black", fill=NA, size=.5), axis.title.x = element_blank(), axis.title.y = element_blank())

################################################################
################################################################
################################################################

library("gridExtra")
grid.arrange(a, b, ncol = 2, nrow = 1)


```

see Figure \@ref(fig:scalelevelgraphs)

\newpage

# Discussion

## Future directions

So, what can be done about the findings that people experience both? @lepine2005meta and @podsakoff2007differential encourage organizations to incorporate strain-reducing activities like train and support to offset the negative effects of challenging job demands. 

There may be some practical utility to pursue training interventions aimed at *how* characteristics are appraised. Perhaps the clinical literature may be informative - for example, within cognitive behavioral therapeutic applications, the way in which situations are appraised can be a mechanism to help battle affective disorders such as depression.[^check] Given the current findings, where the same characteristic may be viewed similarly as both a demand and resource, it is possible that framing interventions may ameliorate negative outcomes of demands such as, for example, stress or strain.

[^check]: Check on this - this is just speculative place-holding from 12/2 Hudson coffee discussion

\newpage

# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup
