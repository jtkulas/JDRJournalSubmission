---
title             : "Shared Characterizations of Challenging Demands and Job Resources across O*NET Element Classifications"
shorttitle        : "O*NET JD-R"

author: 
  - name          : "Alicia Stachowski"
    affiliation   : "2"
    corresponding : yes    # Define only one corresponding author
  - name          : "John Kulas"
    affiliation   : "1"
    email         : "jtkulas@ergreports.com"
  - name          : "Renata García Prieto Palacios Roji"
    affiliation   : "3"

affiliation:
  - id            : "1"
    institution   : "eRg"
  - id            : "2"
    institution   : "University of Wisconsin - Stout"
  - id            : "3"
    institution   : "PepsiCo"

authornote: |
 Funding: This work was supported by the College of Humanities and Social Sciences, Montclair State University, Montclair, NJ. 

abstract: |
  Discussions of job characteristics often include a tacit characterization that these job elements are either resources or demands. The current study documents variability in ratings of O\*NET specifications with respect to subjective interpretation of job characteristics and predicts the form of demand (challenge or hindrance) will exhibit differential association with work--related outcomes. We additionally explore the potential moderating role of resources on these relationships. Results support the perspective that job characteristics are not uniquely categorized as a resource or demand, but rather, what is viewed as challenging is also commonly be interpreted as resourceful. Furthermore, greater experienced resources moderate the challenge--engagement relationship as well as the hindrance-stress and hindrance--burnout relationships. These findings broadly support the non--mutually exclusive perspective on job characteristic appraisal as well as multiple theoretically--specified outcome associations. 
  
keywords         : "O*NET, challenge-hindrance framework, job demands-resources, job characteristics"
wordcount        : "4,942"

bibliography     : ["r-references.bib", "jdr.bib", "jobdemands_resources_bibtex.bib"]

floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : no
mask              : no
draft             : no

csl               : "sage-harvard.csl"
documentclass     : "apa7" #interact
classoption       : "man"
output:
  papaja::apa6_pdf:
    latex_engine: xelatex 
---

```{r setup, include = FALSE}

library("papaja")

```

```{r analysis-preferences, echo=FALSE, warning=FALSE, message=FALSE}

# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed, echo=FALSE, warning=FALSE, message=FALSE)

```

8,000 words inclusive of everything, references, etc

Abstract = 150 words

preference for Word document

While we have accumulated a vast literature on how job demands and resources relate to and influence key organizational outcomes, recent work has called into question some of our basic assumptions regarding the experience of demands in particular. We build on a growing number of researchers who argue that work elements may be appraised simultaneously as resources and demands [@webster2011extending] or that appraisals may change over time [@rosen2020challenges]. Our primary aims explore: 1) variability in subjective ratings of job characteristics with respect to perception as resource and/or demand, 2) differential association (of subjective appraisals) with positive and negative outcomes, and 3) the buffering effect of resources on the relationships between demands and negative work outcomes^[Took out previous #2 -- make sure this isn't revisited in Results or Discussion]. We investigate these associations via the lens of [O\*NET job specifications](https://www.onetcenter.org/content.html), which provide a near--exhaustive listing of generalizable characteristic specifications. 

## Theoretical Foundations

Job demands-resources theory (e.g., Bakker & Demerouti, 2014; 2017) highlights the importance of demands and resources on the employee experience of motivation and strain as well as other, less proximal outcomes. Resources include physical, psychological, social, or organizational aspects of jobs that help an employee achieve work goals, reduce job demands, or promote personal growth and development [e.g., @bakker2014job; @bakker2017job]. In contrast, demands include components of a job that require sustained effort, and as such, produce psychological or physiological strain (high work pressure, for example, is commonly cited as a demand, e.g., Demerouti et al., 2001). The perception of an element of one’s job as a resource or demand activates one of two distinct processes: either health impairment (resulting from demands) or motivation (resulting from resources; @bakker2014job). 

@cavanaugh2000empirical extended this framework by proposing a distinction between *two forms* of demands -- *challenges* and *hindrances*. Challenge demands promote mastery, personal growth, and future gains. These demands should lead to coping strategies that facilitate achievement. Work characteristics consistent with this definition, for example, include time pressure and responsibility [@lepine2022challenge]. Hindrance demands, in contrast, inhibit growth, learning, and the general achievement of goals. Example hindrance demands that have been previously noted include role conflict and role ambiguity [@lepine2022challenge].

```{r reproduced, eval=FALSE, echo=FALSE, fig.cap="Going to put in new comprehensive picture."}
library(magick)
library(grid)

figure <- image_read("Reproduced_LepineFigure.png")

grid.raster(figure) # works well with margins/etc

```

@lepine2022challenge deconstructs the mechanisms by which demands are related to performance and wellbeing outcomes. First, demands appraised as *challenges* typically result in a more positive appraisal, and engagement is likely to happen as a result. Engagement, in turn, is positively related to motivation, performance, growth, and wellbeing. Demands appraised as *hindrances* elicit a different process. Disengagement is likely to result from a hindrance appraisal, which then negatively impacts motivation, performance, growth and wellbeing. This happens because resources are depleted via frustrations and other negative affect--laden reactions [@lepine2022challenge]. 

Meta-analytic explorations of the challenge-hindrance stressor framework have generally been supportive of the framework's propositions (see, for example, @lepine2005meta regarding performance and @crawford2010linking regarding engagement). @pindek2024dynamic meta-analyzed diary studies of dynamic demands (i.e., short-term daily experiences of demands) and concluded that daily challenge demands had a positive *direct* association with performance, but a negative *indirect* association with performance through strain (as described by @lepine2022challenge above). As expected, hindrance demands had both direct and indirect (through strain) associations with performance [@pindek2024dynamic].

Interestingly, much of our existing knowledge regarding the way these relationships between resources/demands and outcomes (e.g., stress, engagement) function is grounded in the assumption that certain job characteristics can generally be considered to be (positive) resources while others can be considered demands. @pindek2024dynamic notes these *a priori* classification of characteristics as demands, challenges, or hindrances as a methdological limitation, as do @horan2020review. In fact, although much of our research on job demands is based on such exclusive classifications [@searle2015merits], the most recent literature suggests that the classification of a work characteristic as a demand or resource is largely subjective by nature (e.g., two different employees could most certainly perceive "daily interaction with co-workers" as a resource or as a demand).

Aligned with this relativistic perspective on the experience of work, @horan2020review and @lepine2022challenge explicitly articulate the need for future research to incorporate the *appraisal process* into the challenge-hindrance stressor framework. In fact, @horan2020review state that “…stressors are only challenge or hindrance demands to the extent that they are perceived as such by employees” (p. 3). They go on to suggest future research continue to move away from *a priori* classifications of demands, as doing so can be problematic for theoretical and empirical reasons. 

Given the above, the first question we pose is whether workers exclusively experience job elements as resources, challenges, or hindrances, or whether a given job characteristic might be mutually considered as more than one of these (e.g., both a challenge and a resource). Evidence suggests that employees do, at least, differentiate between challenge and hindrance demands [e.g., @bakker2013weekly; @gerich2017relevance; @webster2011extending]. For example, @bakker2013weekly found that work pressure was perceived as a hindrance, and emotional demands as more of a challenge. @webster2011extending approached this question with three commonly implicated workplace demands: workload, role ambiguity, and role conflict. They found while that each could be appraised primarily as a challenge or hindrance, they could also simultaneously be perceived as being both a challenge and hindrance to different degrees. We aim to both replicate the above findings and extend them to include resources.

>Hypothesis 1: Job characteristics vary regarding subjective worker perception as challenge, hindrance, or resource

>Hypothesis 2: Job characteristics are not exclusively categorized as a resource or demand, but rather, some job characteristics are viewed as both resourceful and demanding

## Connecting Appraisals to Workplace Outcomes

Both the job demands--resources model [@bakker2017job] as well as the challenge--hindrance stressor framework [@cavanaugh2000empirical] have been useful in the prediction of a wide variety of organizational outcomes including job satisfaction, motivation, commitment, and performance [e.g., @lepine2005meta]. Empirical work generally suggests that *resources* are commonly associated with positive outcomes, including, most relevant for the current investigation, employee engagement. For example, @hakanen2008job found that job resources influenced future work engagement. Moreover, in a sample of teachers and dentists, @bakker2007job found that resources were most predictive of engagement when job demands were especially high. Meta analyses have also concluded that there is a positive association with a variety of resource elements and engagement [e.g., @schaufeli2017applying]. 

```{r ourmodel, eval=TRUE, echo=FALSE, fig.cap="Focal constructs and predicted associations"}
library(magick)
library(grid)

figure2 <- image_read("ourmodel.png")

grid.raster(figure2) # works well with margins/etc

```

The findings regarding demands are more complex. When a demand is appraised as a hindrance, it is negatively associated with motivational resources [@kim2020thriving], engagement [@crawford2010linking], job search behaviors, and job satisfaction [@cavanaugh2000empirical]. @chen2021daily further found that daily hindrance demands were negatively associated with cognitive wellbeing and work family enrichment. Turnover intentions, actual turnover and withdrawal behaviors have also been associated with hindrance demands [@podsakoff2007differential]. Appraising a demand as a *challenge*, however, has been positively associated with sources of motivation (i.e., sense of self-worth and meaningful work, @chen2021daily, engagement, @crawford2010linking, and strain and turnover intentions, e.g., @abbas2019challenge). Challenge appraisals have also been found to ehave negative associations with job search behaviors [e.g., @cavanaugh2000empirical]. Interestingly, both challenges and hindrances have been shown to positively predict strain [@abbas2019challenge; @lepine2005meta; @podsakoff2007differential; @webster2010toward], which further highlights the complex association between characteristic appraisals and important work outcomes. Given the differential relationships described above, and a focus on three outcomes (engagement, strain, and burnout) we make the following predictions (see Figure \@ref(fig:ourmodel)):

>Hypothesis 3a: Resources and challenges positively predict engagement.  

>Hypothesis 3b: Both challenge and hindrance demands positively predict stress and burnout. 

In addition to the these direct relationships, we aim to extend work suggesting that resources can act as a buffer between job demands and strain [e.g., @bakker2005job] and burnout [e.g., @xanthopoulou2007job]. Bakker and colleagues (2005) were the first to report empirical evidence to support the idea that job resources could potentially buffer the negative impact of job demands on distal outcomes like burnout. @bakker2005job explored the interaction between 4 demands (e.g., work overload, physical demands) and 4 resources (e.g., social support, feedback) and three dimensions of burnout (exhaustion, cynicism, and professional efficacy), and found some support for the prediction that high demands with low resources predicted greater levels of cynicism and exhaustion among employees in higher education. Similarly, @xanthopoulou2007job also found some support for this interaction (high demands + low resources leads to greater burnout) among home healthcare employees. They concluded that a variety of resources, including autonomy, social support, performance feedback, and opportunities for professional development buttered the connection between demands (i.e., patient harassment, workload, physical and emotional demands) and burnout. We extend the established job demands-resources model buffer proposition to both challenge and hindrance demands as follows (see Figure \@ref(fig:ourmodel)):

>Hypothesis 4a:Resources moderate the relationship between challenge demands and the outcomes of strain and burnout such that these relationships become weaker as workers perceive more resources.

>Hypothesis 4b:Resources moderate the relationship between hindrance demands and the outcomes of strain and burnout such that these relationships become weaker as workers perceive more resources.


```{r study1}

temp <- read.csv("initial_data_screen.csv", header=FALSE, na.strings="")   ## NOTE: 404 vars (9/28/21) make sure to check indexing used throughout script

x <- paste("item", sep="",1:404)
y <- t(temp[2,])
                                        ## decluttering Qualtrics excess
data <- temp[-c(1:3),]                                           ## Getting rid of all 3 weird Qualtrics rows
colnames(data) <- x

incomplete <- read.csv("inprogress.csv", header=FALSE, na.strings="")   ## NOTE: 404 vars (9/28/21) make sure to check indexing used throughout script

data2 <- incomplete[-c(1:2),-c(10,12,16,113,199,285,371,379,400, 406:411)]                                          

data3 <- as.data.frame(cbind(data2$V8,data2$V9,data2$V1,data2$V1,data2$V1,data2$V1,data2$V1,data2$V1,data2))

colnames(data3) <- x

rm(x, y, temp)       

use <- rbind(data,data3)

## STILL NEED FILE WITH BAD RESPONDENTS IDENTIFIED (E.G., Item_18=2, na > 200, longstring > 20, CARELESS CHECKS > 1)

library(careless)
use$careless_long <- longstring(use[18:399])
use$missing <- rowSums(is.na(use[18:404])) 

different <- use[ which(use$item18 == 2 | use$careless_long > 20 | use$missing > 200), ]

attention <- use[which(use$item61 == 5 & use$item145 == 5 & use$item248 == 2 & use$item308 == 3), ]

data <- data.frame(lapply(attention, function(x) as.numeric(as.character(x))))
data <- data[,c(1:404)]

numtot <- nrow(use)
numkicked <- nrow(different)
numvalid <- nrow(data)

```

```{r demos}

a <- descr::freq(use$item401, plot=FALSE)

use$item402[use$item402 == "Female " | use$item402 == "female" | use$item402 == "FEMALE" | use$item402 == "Woman" | use$item402 == "Mujer" | use$item402 == "feminine" | use$item402 == "fEMALE" | use$item402 == "F" | use$item402 == "Femenale" | use$item402 == "feminino" | use$item402 == "female " | use$item402 == "Fem" | use$item402 == "Feminine" | use$item402 == "feminine" | use$item402 == "WOMAN" | use$item402 == "Femal" | use$item402 == "femenine" | use$item402 == "Femenine" | use$item402 == "femenino" | use$item402 == "woman"]  <- "Female"

use$item402[use$item402 == "gerente" | use$item402 == "M" | use$item402 == "Make" | use$item402 == "Mal" | use$item402 == "male" | use$item402 == "MALE" | use$item402 == "male" | use$item402 == "Male" | use$item402 == "mals" | use$item402 == "man" | use$item402 == "masculine" | use$item402 == "Masculine" | use$item402 == "Man" | use$item402 == "mals " | use$item402 == "male " | use$item402 == "Male "]  <- "Male"

b <- descr::freq(use$item402, plot=FALSE)

##Job title
library(labourR)


#ESCO/ISCO classification using the labourR package
#ISCO = International Standard Classification of Occupations

attention$id <- 1:nrow(attention) #adds unique identifier to satisfy inane requirement of classify_occupation()

ISCO <- classify_occupation(attention, text_col = 'item400', isco_level = 1) 

m3 <-merge(attention, ISCO, by.x = "id", by.y = "id", all.x = TRUE)

c <- descr::freq(m3$preferredLabel, plot=FALSE)

knowledge <- data[ which(m3$iscoGroup == "1" | m3$iscoGroup == "2"), ]
service <- data[ which(m3$iscoGroup == "3" | m3$iscoGroup == "4" | m3$iscoGroup == "5" | m3$iscoGroup == "6" | m3$iscoGroup == "7" | m3$iscoGroup == "8" | m3$iscoGroup == "9"), ]

data$item403[data$item403 == 2000]  <- 20

```


```{r generalrecodes, include=FALSE}

source("recodescript.R", local = knitr::knit_global())

```

# Method

```{r litresources}

###############################################
############################################### include & eval=FALSE on 1/16/23 because of new figure which replaced this older attempt

### ACTUALLY, just commented out the graph because other code chunks needed for subsequent commands - 1/17/23 , fig.cap="Average and standard deviation of O*NET characteristics retained as indicators of Autonomy, Cohesion, Control, Participation, and Supervisor Support."


labels <- read.csv("truncatedlabels.csv", header=FALSE)  ## Changed on 12/19 to fix zero sd issues       

resource <- as.data.frame(t(data[118:202]))           

resource$description <- labels[c(118:202),1]
resource$mean <- round(rowMeans(resource[1:nrow(data)], na.rm=TRUE),2)
resource$sd   <- round(apply(resource[1:nrow(data)], 1, sd, na.rm=TRUE),2)

resource <- resource[-28,]   ## attention check


resource.control <- resource[ which(resource$description=='job structured for you, rather than allowing you to determine tasks, priorities, and goals' | resource$description=='regular work schedules'), ]
resource.control$category <- "Control"

resource.participation <- resource[ which(resource$description=='responsible for work outcomes and results of other workers' | resource$description=='responsibility for the health and safety of others' | resource$description=='developing specific goals and plans to prioritize, organize, and accomplish your work' | resource$description=='scheduling events, programs, and activities, as well as the work of others' | resource$description=='developing, designing, or creating new applications, ideas, relationships, systems, or products' | resource$description=='providing information to supervisors, co-workers, and subordinates by telephone, in written form, e-mail, or in person'), ]
resource.participation$category <- "Participation"

resource.sup.support <- resource[ which(resource$description=='providing guidance and expert advice to management or other groups on technical, systems-, or process-related topics' | resource$description=='identifying the educational needs of others, developing formal educational or training programs or classes, and teaching or instructing others'), ]
resource.sup.support$category <- "Support"

resource.autonomy <- resource[ which(resource$description=='decision making freedom, without supervision'), ]
resource.autonomy$category <- "Autonomy"

resource.cohesion <- resource[ which(resource$description=='work with others in a group or team' | resource$description=='getting members of a group to work together to accomplish tasks' | resource$description=='' | resource$description=='' | resource$description=='' | resource$description=='encouraging and building mutual trust, respect, and cooperation among team members'), ]
resource.cohesion$category <- "Cohesion"

notedresource <- rbind(resource.control, resource.participation, resource.sup.support, resource.autonomy, resource.cohesion)
notedresource$RD <- "Resource"


#########################################################
#########################################################


challenge <- as.data.frame(t(data[288:372]))           

challenge$description <- labels[c(288:372),1]
challenge$mean <- round(rowMeans(challenge[1:nrow(data)], na.rm=TRUE),2)
challenge$sd   <- round(apply(challenge[1:nrow(data)], 1, sd, na.rm=TRUE),2)


challenge <- challenge[-21,]

challenge.control <- challenge[ which(challenge$description=='job structured for you, rather than allowing you to determine tasks, priorities, and goals' | challenge$description=='regular work schedules'), ]
challenge.control$category <- "Control"

challenge.participation <- challenge[ which(challenge$description=='responsible for work outcomes and results of other workers' | challenge$description=='responsibility for the health and safety of others' | challenge$description=='developing specific goals and plans to prioritize, organize, and accomplish your work' | challenge$description=='scheduling events, programs, and activities, as well as the work of others' | challenge$description=='developing, designing, or creating new applications, ideas, relationships, systems, or products' | challenge$description=='providing information to supervisors, co-workers, and subordinates by telephone, in written form, e-mail, or in person'), ]
challenge.participation$category <- "Participation"

challenge.sup.support <- challenge[ which(challenge$description=='providing guidance and expert advice to management or other groups on technical, systems-, or process-related topics' | challenge$description=='identifying the educational needs of others, developing formal educational or training programs or classes, and teaching or instructing others'), ]
challenge.sup.support$category <- "Support"

#challenge.autonomy <- challenge[ which(challenge$description=='decision making freedom, without supervision'), ]
#challenge.autonomy$category <- "Autonomy"

challenge.cohesion <- challenge[ which(challenge$description=='work with others in a group or team' | challenge$description=='getting members of a group to work together to accomplish tasks' | challenge$description=='' | challenge$description=='' | challenge$description=='' | challenge$description=='encouraging and building mutual trust, respect, and cooperation among team members'), ]
challenge.cohesion$category <- "Cohesion"

notedchallenge <- rbind(challenge.control, challenge.participation, challenge.sup.support,  challenge.cohesion)     ## removed challenge.autonomy 8/24/22
notedchallenge$RD <- "Challenge"

############################################################
############################################################


hindrance <- as.data.frame(t(data[203:287]))           

hindrance$description <- labels[c(203:287),1]
hindrance$mean <- round(rowMeans(hindrance[1:nrow(data)], na.rm=TRUE),2)
hindrance$sd   <- round(apply(hindrance[1:nrow(data)], 1, sd, na.rm=TRUE),2)

hindrance <- hindrance[-46,]   ## attention check = 248


hindrance.control <- hindrance[ which(hindrance$description=='job structured for you, rather than allowing you to determine tasks, priorities, and goals' | hindrance$description=='regular work schedules'), ]
hindrance.control$category <- "Control"

hindrance.participation <- hindrance[ which(hindrance$description=='responsible for work outcomes and results of other workers' | hindrance$description=='responsibility for the health and safety of others' | hindrance$description=='developing specific goals and plans to prioritize, organize, and accomplish your work' | hindrance$description=='scheduling events, programs, and activities, as well as the work of others' | hindrance$description=='developing, designing, or creating new applications, ideas, relationships, systems, or products' | hindrance$description=='providing information to supervisors, co-workers, and subordinates by telephone, in written form, e-mail, or in person'), ]
hindrance.participation$category <- "Participation"

hindrance.sup.support <- hindrance[ which(hindrance$description=='providing guidance and expert advice to management or other groups on technical, systems-, or process-related topics' | hindrance$description=='identifying the educational needs of others, developing formal educational or training programs or classes, and teaching or instructing others'), ]
hindrance.sup.support$category <- "Support"

hindrance.autonomy <- hindrance[ which(hindrance$description=='decision making freedom, without supervision'), ]
hindrance.autonomy$category <- "Autonomy"

hindrance.cohesion <- hindrance[ which(hindrance$description=='work with others in a group or team' | hindrance$description=='getting members of a group to work together to accomplish tasks' | hindrance$description=='' | hindrance$description=='' | hindrance$description=='' | hindrance$description=='encouraging and building mutual trust, respect, and cooperation among team members'), ]
hindrance.cohesion$category <- "Cohesion"

notedhindrance <- rbind(hindrance.control, hindrance.participation, hindrance.sup.support, hindrance.autonomy, hindrance.cohesion)
notedhindrance$RD <- "Hindrance"

###########################################################
###########################################################  Name issue somehow above 

labels <- names(notedresource)
colnames(notedchallenge) <- labels
colnames(notedhindrance) <- labels

together <- rbind(notedchallenge,notedhindrance,notedresource)

############################################################
############################################################

library(ggplot2)
library(dplyr)

summarized <- together %>%                               # Summary by group using dplyr
  group_by(category, RD) %>% 
  summarize(mean = mean(mean),
            sd = mean(sd))

summarized$RD <- factor(summarized$RD, levels = c("Resource", "Challenge", "Hindrance"))

#ggplot(summarized, aes(x=category, y=mean, fill=RD)) + geom_bar(stat="identity", position=position_dodge()) + theme_bw() + xlab("") + ylab("Average Job Characteristic Rating") + coord_cartesian(ylim=c(1,5)) + scale_fill_brewer(palette="Blues") + 
#  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.5, size=0.8, position=position_dodge(.9))

```

## Participants

We sampled from a Prolific panel with eligibility requirements being 18 years of age (or older) and holding either a full-- or part--time job. The Montclair State University Institutional Review Board approved the project and respondents provided consent after reviewing a project description but before starting the survey. To account for multiple--job holders, participants were asked to think about their primary job while responding. Regarding tenure, `r round(a[1,3],2)`% had been in their referent job less than 6 months, `r round(a[2,3],1)`% between 6 months and a year, `r round(a[3,3],2)`% between one and five years, `r round(a[4,3],2)`% between 5 and 10 years, and `r round(a[5,3],2)`% more than 10 years. Respondent ages ranged from 18 to 65 with an average of `r round(mean(data[,403], na.rm=TRUE),2)` years old (*SD* = `r round(sd(data[,403], na.rm=TRUE),2)`). The survey offered a free-field gender identity category, although the sample predominantly self-identified as female (`r round(b[2,3],2)`%) or male (`r round(b[5,3],2)`%). 

## Materials

>NOTE. grab O\*NET description from desktop (this paragraph only)

### Characteristics, Challenge Demands, Hindrance Demands, and Resources 

The Occupational Information Network (O\*NET) serves as a repository of information broadly descriptive of occupations [@peterson2001understanding]. The O\*NET database consists of hundreds of standardized and occupation-specific descriptors of occupations in the US and these descriptions are frequently updated. We focused on 98 work [activity and context statements](https://www.ONETonline.org/find/descriptor/result/4.A.1.b.3) which O\*NET groups into *activity* categories of information input (e.g., where and how are the information and data gained that are needed to perform this job?), interacting with others (e.g., what interactions with other persons or supervisory activities occur while performing this job?), mental processes (e.g., what processing, planning, problem-solving, decision-making, and innovating activities are performed with job-relevant information?) and work output (e.g., what physical activities are performed, what equipment and vehicles are operated/controlled, and what complex/technical activities are accomplished as job outputs?). Work *context* statements are grouped into interpersonal relationships (e.g., the context of the job in terms of human interaction processes), physical work conditions (e.g., the work context as it relates to the interactions between the worker and the physical job environment), and structural job characteristics (e.g., the relationships or interactions between the worker and the structural characteristics of the job). 

O\*NET collects information about these elements by periodically surveying workers with job characteristic questions, which often have [unique response categories](https://www.ONETonline.org/find/descriptor/result/4.C.1.c.2).  For example, "How responsible is the worker for work outcomes and results of other workers?" has response options ranging from *no responsibility* to *very high responsibility*, while the question, "How often do you use electronic mail in this job?" has options ranging from *never* to *every day*. We retained O\*NET’s response scales while asking for statement relevance, all of which shared the same number of response option categories (5) regardless of semantic label difference. We also retained original O\*NET wording for our item stems, with minor grammatical exceptions^[For example, the worker responsibility question was changed from "How responsible is the worker..." to "How responsible are you..."]. The total number of items on each administered survey was less than 392 (98 characteristics x 4 repeated measurements) because we did not ask for evaluations for 14 O\*NET characteristics that we surmised to have extremely low frequency of affirmative endorsement across respondents (one such excluded characteristic, for example, was "...the extent to which the worker is exposed to radiation on the job"). 

Participants were first asked to think about whether or not their job could be described as consisting of these job characteristics. If a respondent indicated that any one characteristic was not applicable for their job (e.g., answered *never* or *not at all*), they were not subsequently asked to rate the level of resource (...this aspect of your job is a resource that can be functional in achieving work goals, reduce job demands, or stimulate personal growth/development), challenge (...this aspect of your job is a challenge that can promote mastery, personal growth, or future gains), or hindrance (...this aspect of your job is a hindrance that can inhibit personal growth, learning, and work goal attainment). All questions were administered in randomized order within blocks of characteristic, resource, challenge, and hindrance. 

### Stress 

Stress was captured via three items taken from the Copenhagen Psychosocial Questionnaire (Burr et al., 2019). Responses were provided using a Likert-type scale ranging from (1) Not at All to (5) All the Time. A sample item is, “How often have you had problems relaxing because of your job?”. Coefficient alpha [@cronbach1951coefficient] was 0.85 in this sample. 

### Burnout 

Four items from the Copenhagen Psychosocial Questionnaire (Burr et al., 2019) were used to assess burnout. Again, responses were provided using a Likert-type scale ranging from (1) Not at All to (5) All the Time. A sample item is, “How often have you felt worn out?”. Within our sample, coefficient alpha was 0.85.

### Engagement 

The 18-item engagement measure was recently developed by Russell et al. (2022). Responses were provided using a Likert-type scale ranging from (1) Strongly Disagree to (6) Strongly Agree. A sample item is, “I enjoy thinking about work even when I'm not at work”. For the purposes of the current study, we focused on an overall engagement score (18 item aggregate, $\alpha$ = 0.91). 

## Procedure  

Respondents were asked to think about their primary job, and each administered survey branched content dependent on whether or not the respondent's job could be described as consisting of the different O\*NET job characteristics. Participants were compensated six USD for their participation (the estimated time commitment pre-administration was 45 minutes). See Figure \@ref(fig:onetviz) for a visual representation of the survey experience. 

```{r onetviz, fig.cap="Visual representation of how respondents experienced the survey."}
library(magick)
library(grid)

onetviz <- image_read("current_submission/Methods_visual.png")
grid.raster(onetviz)
```


# Results  

Of the `r nrow(use)` individuals who initially accessed the survey link, `r nrow(different)` indicated that they were not interested, had more than 200 missing responses, or had 20 or more identical consecutive sequential responses [@R-careless]. Applying a further screen regarding attention checks (there were four attention checks embedded throughout, asking respondents to indicate a specific answer) resulted in the retention of `r nrow(data)` respondents who constitute the current sample. 

```{r resourcesagree, fig.cap="Characteristics most similarly viewed as resources (lowest standard deviations)."}

sortresource <- resource[order(resource$sd),]

topresource <- head(sortresource, 8)    ## changed for combined plot (1/28/23)

topresource <- topresource[tail(names(topresource),3)]        

library(ggplot2)

a <- ggplot(topresource, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="blue", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Most Consensus as a Resource") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,6)) 

```

```{r challengesagree, fig.cap="Characteristics most similarly viewed as challenges (lowest standard deviations)."}

sortchallenge <- challenge[order(challenge$sd),]

topchallenge <- head(sortchallenge, 8)    ## changed for combined plot (1/28/23)

topchallenge <- topchallenge[tail(names(topchallenge),3)]        

b <- ggplot(topchallenge, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="yellow", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Most Consensus as a Challenge") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,6)) 


```

```{r hindrancesagree, fig.cap="Characteristics most similarly viewed as hindrances (lowest standard deviations)."}

sorthindrance <- hindrance[order(hindrance$sd),]

tophindrance <- head(sorthindrance, 8)  ## changed for combined plot (1/28/23)

tophindrance <- tophindrance[tail(names(tophindrance),3)]        

c <- ggplot(tophindrance, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="red", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Most Consensus as a Hindrance") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,6))

## added 2/7/23 for online supplement materials

resourcetemp <- sortresource[,c(569:571)]
challengetemp <- sortchallenge[,c(569:571)]
hindrancetemp <- sorthindrance[,c(569:571)]

write.csv(resourcetemp, "sortresource.csv")
write.csv(challengetemp, "sortchallenge.csv")
write.csv(hindrancetemp, "sorthindrance.csv")

```

```{r combinegraphs, fig.cap="Characteristics percieved most similarly (lowest standard deviations).", fig.height=10}

library(gridExtra)
grid.arrange(b, c, a, nrow = 3)

```

```{r resourcesdisagree, fig.cap="Characteristics most *dis*similarly viewed as resources (highest standard deviations)."}

resource <- resource[ which(resource$sd > 0), ] 

sortresource <- resource[order(-resource$sd),]

bottomresource <- head(sortresource, 8)

bottomresource <- bottomresource[tail(names(bottomresource),3)]        

d <- ggplot(bottomresource, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="blue", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Lack of Consensus as a Resource") + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,6)) 

```

```{r challengesdisagree, fig.cap="Characteristics most *dis*similarly viewed as challenges (highest standard deviations)."}

sortchallenge <- challenge[order(-challenge$sd),]

bottomchallenge <- head(sortchallenge, 8)

bottomchallenge <- bottomchallenge[tail(names(bottomchallenge),3)]        

e <- ggplot(bottomchallenge, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="yellow", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Lack of Consensus as a Challenge") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,6)) 


```

```{r hindrancesdisagree, fig.cap="Characteristics most *dis*similarly viewed as hindrances (highest standard deviations)."}


sorthindrance <- hindrance[order(-hindrance$sd),]

bottomhindrance <- head(sorthindrance, 8)

bottomhindrance <- bottomhindrance[tail(names(bottomhindrance),3)]        

f <- ggplot(bottomhindrance, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="red", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Lack of Consensus as a Hindrance") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,6))

```

```{r combinegraphs2, fig.cap="Characteristics percieved most **dissimilarly** (largest standard deviations).", fig.height=10}

library(gridExtra)
grid.arrange(e, f, d, nrow = 3)

```

```{r overallhist, fig.cap="Frequency distribution of standard deviations across characteristics deemed resources, challenges, and demands."}

## resource$sd

toplotresource <- resource
toplotchallenge <- challenge
toplothindrance <- hindrance

toplotresource$RD <- "Resource"
toplotchallenge$RD <- "Challenge"
toplothindrance$RD <- "Hindrance"

toplottogether <- rbind(toplotresource,toplotchallenge,toplothindrance)

library(ggplot2)
#ggplot(resource, aes(x=sd)) + geom_histogram()
ggplot(toplottogether, aes(x=sd)) + geom_histogram() + facet_grid(RD ~ .) + labs(x = "Standard Deviation")

lookie <- stats::bartlett.test(sd ~ RD, toplottogether)

```

>NOTE. Get rid of Fig 3 - present the histograms as indicating that "not everyone agrees that a characterisitic is a... (challenge, hindrance, resource)", then highlight items with greatest discrepancy to provide flavor to the histograms (flip the current $\P$ ordering)

H1 posits that the same job characteristic is not necessarily experienced similarly across workers - as hindrance, challenge, or resource. We explore this hypothesis first at the job characteristic level before presenting a broader perspective. Figures \@ref(fig:combinegraphs) and \@ref(fig:combinegraphs2) present only extreme snapshots of characteristic variability in the form of the 8-most *consistently rated* and *inconsistently rated* resources, challenges, and demands.[^onlinelist] Figure \@ref(fig:combinegraphs) presents the resources, challenges, and hindrances that are *most consistently agreed on* as indexed by lowest empirical standard deviations, while Figure \@ref(fig:combinegraphs2) presents the characteristics with the greatest amount of *disagreement* across workers. The figures demonstrate that what is perceived as resource and challenge tends to be somewhat agreed upon (the range of the "lowest 8" resource standard deviations is `r min(topresource$sd)` to `r max(topresource$sd)` and the range of lowest 8 challenge standard deviations is `r min(topchallenge$sd)` to `r max(topchallenge$sd)`). However, there is considerably less agreement regarding the degree to which job elements should be considered to be hindrances, with the 8 elements showing the *greatest agreement* still ranging in fairly large standard deviations (ranging from `r min(tophindrance$sd)` to `r max(tophindrance$sd)`).

 [^onlinelist]: A full list of item characteristic ratings, along with summary averages and standard deviations is available in supplementary online resources. The Figures \@ref(fig:combinegraphs) and \@ref(fig:combinegraphs2) presentations are only limited to 8 characteristics per perceived category because of space restrictions (there are 252 individual characteristic ratings in the online resources).

In addition to highlighting extremely agreed-- or disagreed--upon characteristics, Figure \@ref(fig:overallhist) presents our standard deviation indices across all rated items. Here, discrepancies receive greater context, with the *spread* of difference exhibiting wider distributions of agreement for challenge and resource ratings (and relatively *bunched* levels of disagreement for hindrances; note the spread of the challenge and resource histograms relative to the hindrance histogram). Some characteristics are largely agreed upon as being challenges and resources, while all hindrance perceptions exhibit a relatively higher level of disagreement. This points to *hindrances*, in particular, as being likely amenable to future probing regarding moderating conditions. A Bartlett's test for homogeneity of variance across the challenge, hindrance, and resource ratings confirms this difference ($\chi^2_{`r lookie$df`}$ = `r lookie$statistic[[1]]`, *p* < .01). In sum, these results provide some collective support for H1, and  particularly so for hindrances, which are differently experienced across our raters.

The second hypothesis, similarly oriented to H1, stated that job characteristics would not be *uniquely* categorized as a resource or demand. Table 1 provides the correlations among the O\*NET "scale"--level groupings^[Survey items are grouped by O\*NET into categories of Information Input (ii), Mental Processes (mp), Work Output (wo), Interacting with Others (io), Interpersonal Relationships (ir), Physical Work Conditions (pc), and Structural Job Characteristics (sc). These groupings were not presented to respondents but are leveraged here to facilitate interpretation of characteristic association.] across evaluations as resource, challenge, and hindrance. Here would expect trivial correlations if job characteristics *were* uniquely categorized. First, the average correlation within all resource categories (variables 1 through 7 in Table 1) was .43 (*SD* = .13, coefficient magnitude ranges from .15 to .64), and challenge categories exhibited similar associations (ranging from .12 to .70, *M* = .43, *SD* =.16). Hindrance categories, however, had less differentiation across categories, with relatively elevated correlations ranging from .33 to .86, *M* = .62, *SD* = .17. When people perceive hindrances, these seem to be shared across different types of job activities, whereas challenges and resources exhibit greater differentiation. 

The mean resource to challenge correlations within the same dimension ranged from .62 to .66 (*M* = .64, *SD* = .02; for example, the association between information input ratings as a resource and as a challenge was .62). The correlations between resources and challenges *across* dimensions (for example, the correlation between mental processes and work output was .42 and .39) ranged from .08 to .50, *M* = .32, *SD* = .12. The resource-hindrance correlations within the same dimension ranged from -.16 to -.30 (*M* = -.24, *SD* = .05), while the correlations between resources and hindrances *across* dimensions ranged from .05 to -.27, *M* = -.14, *SD* = .08. The mean challenge to hindrance correlations within the same dimension ranged from -.04 to -.27 (*M* = -.21, *SD* = .08). The correlations between challenges to hindrances across dimensions ranged from .12 to -.26, *M* = -.11, *SD* = .09.  In summary, correlations were larger when what was being rated was the same type of characteristic. Challenge and hindrance demands demonstrated smaller relationships, but mostly negative. Challenges and resources within the same O\*NET dimensions are strongly and positively related. These results provide support for H2, suggesting that there is overlap in how employees perceive job characteristics - particularly regarding what is perceived as a *resource* being also perceived as a *challenge*. Stated differently, job characteristics should not be uniquely categorized as resource or demand.

The next group of hypotheses focuses on the relationship among resources and demands (challenge and hindrance) and outcomes. Table 2 shows the overall associations between resource/challenge/hindrances and outcomes of engagement, stress, and burnout. Here, we observe positive associations between resources, and challenges with engagement, and a negative association between hindrances and engagement. A positive association is observed between hindrances and stress. 

```{r cortab, results="asis", eval=TRUE}

data_new <- data

## O*NET categories

data_new$onet.resource.ii <- rowMeans(data_new[c(162:166)], na.rm=TRUE)
data_new$onet.resource.mp <- rowMeans(data_new[c(167:176)], na.rm=TRUE)
data_new$onet.resource.wo <- rowMeans(data_new[c(177:185)], na.rm=TRUE)
data_new$onet.resource.io <- rowMeans(data_new[c(186:202)], na.rm=TRUE)
data_new$onet.resource.ir <- rowMeans(data_new[c(149:161)], na.rm=TRUE)
data_new$onet.resource.pc <- rowMeans(data_new[c(128:144,146:148)], na.rm=TRUE)
data_new$onet.resource.sc <- rowMeans(data_new[c(118:127)], na.rm=TRUE)

data_new$overall.resource <- rowMeans(data_new[c(118:144,146:202)], na.rm=TRUE)

data_new$onet.hindrance.ii <- rowMeans(data_new[c(246:247,249:252)], na.rm=TRUE)
data_new$onet.hindrance.mp <- rowMeans(data_new[c(252:261)], na.rm=TRUE)
data_new$onet.hindrance.wo <- rowMeans(data_new[c(262:270)], na.rm=TRUE)
data_new$onet.hindrance.io <- rowMeans(data_new[c(271:287)], na.rm=TRUE)
data_new$onet.hindrance.ir <- rowMeans(data_new[c(233:245)], na.rm=TRUE)
data_new$onet.hindrance.pc <- rowMeans(data_new[c(213:232)], na.rm=TRUE)
data_new$onet.hindrance.sc <- rowMeans(data_new[c(203:212)], na.rm=TRUE)

data_new$overall.hindrance <- rowMeans(data_new[c(203:247,249:287)], na.rm=TRUE)

data_new$onet.challenge.ii <- rowMeans(data_new[c(332:336)], na.rm=TRUE)
data_new$onet.challenge.mp <- rowMeans(data_new[c(337:346)], na.rm=TRUE)
data_new$onet.challenge.wo <- rowMeans(data_new[c(347:355)], na.rm=TRUE)
data_new$onet.challenge.io <- rowMeans(data_new[c(356:372)], na.rm=TRUE)
data_new$onet.challenge.ir <- rowMeans(data_new[c(319:331)], na.rm=TRUE)
data_new$onet.challenge.pc <- rowMeans(data_new[c(298:307,309:318)], na.rm=TRUE)
data_new$onet.challenge.sc <- rowMeans(data_new[c(288:297)], na.rm=TRUE)

data_new$overall.challenge <- rowMeans(data_new[c(288:307,309:372)], na.rm=TRUE)

data_new$burnout      <- rowMeans(data_new[c(373:376)], na.rm=TRUE)
data_new$stress       <- rowMeans(data_new[c(377:379)], na.rm=TRUE)
data_new$engagement   <- rowMeans(data_new[c(380:399)], na.rm=TRUE)        ## added 10/12 because analyses too wonky with 3 subscales

names(data_new)[names(data_new) == "stress"] <- "Stress"
names(data_new)[names(data_new) == "overall.challenge"] <- "Challenge"
names(data_new)[names(data_new) == "overall.hindrance"] <- "Hindrance"
names(data_new)[names(data_new) == "overall.resource"] <- "Resource"

## Was originally overall: "Challenge", "Hindrance", "Resource"

r <- corx::corx(data_new, x =c("onet.resource.ii", "onet.resource.mp", "onet.resource.wo",  "onet.resource.io", "onet.resource.ir", "onet.resource.pc", "onet.resource.sc", "onet.challenge.ii", "onet.challenge.mp", "onet.challenge.wo",  "onet.challenge.io", "onet.challenge.ir", "onet.challenge.pc", "onet.challenge.sc","onet.hindrance.ii", "onet.hindrance.mp", "onet.hindrance.wo", "onet.hindrance.io", "onet.hindrance.ir", "onet.hindrance.pc", "onet.hindrance.sc"), y =c("onet.resource.ii", "onet.resource.mp", "onet.resource.wo",  "onet.resource.io", "onet.resource.ir", "onet.resource.pc", "onet.resource.sc", "onet.challenge.ii", "onet.challenge.mp", "onet.challenge.wo", "onet.challenge.io", "onet.challenge.ir", "onet.challenge.pc", "onet.challenge.sc","onet.hindrance.ii", "onet.hindrance.mp", "onet.hindrance.wo", "onet.hindrance.io", "onet.hindrance.ir", "onet.hindrance.pc", "onet.hindrance.sc"),            
                triangle = "lower",
                stars = c(0.05, 0.01)) #, 0.001),
 #               describe = c(`$M$` = mean, `$SD$` = sd))

#rapa <- as.data.frame(r$apa)       

papaja::apa_table(r$apa, # changed from r$apa list 6/23/24
                  caption = "Challenge, hindrance, and resource bivariate correlations.",
                  escape = FALSE, 
                  font_size = "tiny",  ## "tiny" smallest
                  longtable = TRUE,
                  landscape = TRUE,
#                  stub_indents = list(a=1:10, b = 11:21),
                  align = c("m{2.6cm}", rep("m{.7cm}",21)),
                  note = "$*$ p < .05, $**$ p < .01; The seven O*NET grouping categories represented here are: Information Input (ii), Mental Processes (mp), Work Output (wo), Interacting with Others (io), Interpersonal Relationships (ir), Physical Work Conditions (pc), and Structural Job Characteristics (sc)")
trial <- data_new[c(405:411, 413:419, 421:427)]
#library(apaTables)
#apa.cor.table(trial, filename = "cor.doc", show.conf.interval = FALSE, landscape = TRUE)

```

```{r}

names(data_new)[names(data_new) == "engagement"] <- "Engagement"
names(data_new)[names(data_new) == "burnout"] <- "Burnout"

r_second <- corx::corx(data_new, x =c("Challenge", "Hindrance", "Resource", "Stress", "Burnout", "Engagement"),                          triangle = "lower",
                stars = c(0.05, 0.01, 0.001),
                describe = c(`$M$` = mean, `$SD$` = sd))


papaja::apa_table(r_second$apa, 
                  caption = "Overall variable bivariate correlations.",
                  escape = FALSE, 
                  note = "$*$ p < .05, $**$ p < .01, $***$ p < .001")
```

```{r scalelevelgraphs, fig.cap="Average characteristic rating grouped by literature-implicated categorizations."}

#this is a placeholder for the scale level faceted graph found in plotscript_practice script file. 
#Open the Submission .rmd
#Run chunks up to the source recodes chunk (named, `generalrecodes`), and then use the data object
#to create the ggplot

library(ggplot2)
library(plyr)
library(dplyr)

#Demands (resources ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$resources_workpressure <- rowMeans(subset(data, select = c(item120, item121)), na.rm = TRUE)
data$resources_phyworkload_wkover <- rowMeans(subset(data, select = c(item122, item137, item138,
                                                                      item139, item141, item142,
                                                                      item143)), na.rm = TRUE)
data$resources_timepressure <- rowMeans(subset(data, select = c(item125, item126)), na.rm = TRUE)
data$resources_recipientcontact <- rowMeans(subset(data, select = c(item149, item154, item157, 
                                                                    item160, item186, item188, 
                                                                    item192, item197, item200, 
                                                                    item201, item151)), na.rm = TRUE)
data$resources_phyenvironment <- rowMeans(subset(data, select = c(item128, item129,	item130, item132,
                                                                  item133,item134,	item136,	item144,	item146,
                                                                  item147,	item148,	item177,	item180,
                                                                  item182,	item181,	item183)), na.rm = TRUE)
data$resources_emotionaldemands <- rowMeans(subset(data, select = c(item150, item155, item199)), na.rm = TRUE)

#Demands (challenge ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$challenge_workpressure <- rowMeans(subset(data, select = c(item290, item291)), na.rm = TRUE)
data$challenge_phyworkload_wkover <- rowMeans(subset(data, select = c(item292, item307, 
                                                                      item309, item310,	item312,
                                                                      item313,	item314)), na.rm = TRUE)
data$challenge_timepressure <- rowMeans(subset(data, select = c(item295, item296)), na.rm = TRUE)
data$challenge_recipientcontact <- rowMeans(subset(data, select = c(item319, item324, item327,
                                                                    item330, item356, item358,
                                                                    item362, item367, item370,
                                                                    item371, item321)), na.rm = TRUE)
data$challenge_phyenvironment <- rowMeans(subset(data, select = c(item298, item299, item300, item302,
                                                                  item303, item304,item306, item315, item316,
                                                                  item317, item318, item347, item350,
                                                                  item352, item351, item353)), na.rm = TRUE)
data$challenge_emotionaldemands <- rowMeans(subset(data, select = c(item320, item325, item369)), na.rm = TRUE)

#Demands (hindrance ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$hindrance_workpressure <- rowMeans(subset(data, select = c(item205, item206)), na.rm = TRUE)
data$hindrance_phyworkload_wkover <- rowMeans(subset(data, select = c(item207, item222,item223,
                                                                      item224, item226, item227,
                                                                      item228)), na.rm = TRUE)
data$hindrance_timepressure <- rowMeans(subset(data, select = c(item210, item211)), na.rm = TRUE)
data$hindrance_recipientcontact <- rowMeans(subset(data, select = c(item233, item238, item241, 
                                                                    item244, item271, item273,
                                                                    item277,	item282,	item285,
                                                                    item286, item235)), na.rm = TRUE)
data$hindrance_phyenvironment <- rowMeans(subset(data, select = c(item213, item214, item215, item217,
                                                                  item218, item219, item221, item229,
                                                                  item230,	item231,	item232,	
                                                                  item262, item265, item267, item266,
                                                                  item286)), na.rm = TRUE)
data$hindrance_emotionaldemands <- rowMeans(subset(data, select = c(item234, item239, item284)), na.rm = TRUE)

#Resources (resource ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$resource_jobcontrol <- rowMeans(subset(data, select = c(item124, item127)), na.rm = TRUE)
data$resource_participation <- rowMeans(subset(data, select = c(item158, item159,
                                                                item172,	item174, item175,
                                                                item189, item193, item202)), na.rm = TRUE)
data$resource_teamcohesion <- rowMeans(subset(data, select = c(item161, item190, item191)), na.rm = TRUE)
data$resource_autonomy <- rowMeans(subset(data, select = c(item118, item172)), na.rm = TRUE)

#Resources (challenge ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$challenge_jobcontrol <- rowMeans(subset(data, select = c(item294, item297)), na.rm = TRUE)
data$challenge_participation <- rowMeans(subset(data, select = c(item328, item329, item342,
                                                                 item344, item345, item359, item363,
                                                                 item372)), na.rm = TRUE)
data$challenge_teamcohesion <- rowMeans(subset(data, select = c(item331, item360, item361)), na.rm = TRUE)
data$challenge_autonomy <- rowMeans(subset(data, select = c(item288, item342)), na.rm = TRUE)

#Resources (hindrance ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$hindrance_jobcontrol <- rowMeans(subset(data, select = c(item209, item212)), na.rm = TRUE)
data$hindrance_participation <- rowMeans(subset(data, select = c(item242, item243, item257,	item259,
                                                                 item260,	item274,	item278,
                                                                 item287)), na.rm = TRUE)
data$hindrance_teamcohesion <- rowMeans(subset(data, select = c(item245, item275, item276)), na.rm = TRUE)
data$hindrance_autonomy <- rowMeans(subset(data, select = c(item203, item257)), na.rm = TRUE)

#check the autonomy variables
#summary(data$hindrance_autonomy)
#summary(data$challenge_autonomy)
#summary(data$resource_autonomy)

library(tidyr)

toplot <- gather(data, scale, value, resources_workpressure:hindrance_autonomy, factor_key=TRUE)

library(stringr)
toplot$type <- str_sub(toplot$scale, 1,6)
toplot$onet <- str_sub(toplot$scale, 10,-1)

toplot$type[toplot$type == "challe"] <- "Challenge"
toplot$type[toplot$type == "hindra"] <- "Hindrance"
toplot$type[toplot$type == "resour"] <- "Resource"       ## change `onet` later if want to keep graphs

toplot$onet[toplot$onet == "teamcohesion"] <- "Team Cohesion"       
toplot$onet[toplot$onet == "_teamcohesion"] <- "Team Cohesion"  
toplot$onet[toplot$onet == "participation"] <- "Participation"       
toplot$onet[toplot$onet == "_participation"] <- "Participation"  
toplot$onet[toplot$onet == "jobcontrol"] <- "Job Control"       
toplot$onet[toplot$onet == "_jobcontrol"] <- "Job Control"  
toplot$onet[toplot$onet == "autonomy"] <- "Autonomy"       
toplot$onet[toplot$onet == "_autonomy"] <- "Autonomy"  

toplot$onet[toplot$onet == "_emotionaldemands"] <- "Emotional Demands"          ## added 11/18/22 (Hudson)  
toplot$onet[toplot$onet == "_phyenvironment"] <- "Physical Environment"  
toplot$onet[toplot$onet == "_phyworkload_wkover"] <- "Overwork"  
toplot$onet[toplot$onet == "_recipientcontact"] <- "Recipient Contact"  
toplot$onet[toplot$onet == "_timepressure"] <- "Time Pressure"  
toplot$onet[toplot$onet == "_workpressure"] <- "Work Pressure"  

toplotgg <- ddply(toplot, c("type", "onet"), summarise, average = mean(value, na.rm=TRUE))

#table(toplot$onet)

## Probably want to change this to a facet: 3 different grids grouped by literature-described 1) resource, 2) hindrances, and 3) challenge

toplotgg$facet <- c("Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand",
                    "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand",
                    "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand")


##############################################################
##############################################################
################    Plots

demandsplot <- filter(toplotgg, facet == "Lit Demand")
resourcesplot <- filter(toplotgg, facet == "Lit Resource")


## Demands

demandsplot$onet <- factor(demandsplot$onet, levels=c("Work Pressure", "Recipient Contact", "Emotional Demands", "Time Pressure", "Physical Environment", "Overwork"))

a <- ggplot(data=demandsplot, aes(x=onet, y=average, fill=type)) + 
  geom_bar(stat="identity", position=position_dodge(), color="black") + coord_flip(ylim=c(1,5)) + scale_fill_manual(values=c("#000000","#cccccc","#ffffff")) +
  scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
  theme(legend.title=element_blank(), legend.position="none",  panel.border = element_rect(colour = "black", fill=NA, size=.5), axis.title.x = element_blank(), axis.title.y = element_blank())

## Resources

resourcesplot$onet <- factor(resourcesplot$onet, levels=c("Team Cohesion", "Autonomy", "Participation", "Job Control"))

b <- ggplot(data=resourcesplot, aes(x=onet, y=average, fill=type)) + 
  geom_bar(stat="identity", position=position_dodge(), color="black") + coord_flip(ylim=c(1,5)) + scale_fill_manual(values=c("#000000","#cccccc","#ffffff")) +
  scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
  theme(legend.title=element_blank(), legend.position="bottom",  panel.border = element_rect(colour = "black", fill=NA, size=.5), axis.title.x = element_blank(), axis.title.y = element_blank())

################################################################
################################################################
################################################################

library("gridExtra")
#grid.arrange(a, b, ncol = 2, nrow = 1)


```

```{r ANOVAs}

library(tidyr)

foranova <- data
foranova$subject <- 1:nrow(foranova) 
  
anova1 <- gather(foranova,type,score,resources_workpressure:hindrance_autonomy, factor_key=TRUE)

## now need to isolate rows with targeted characteristics

overwork <- anova1[ which(anova1$type=='resources_phyworkload_wkover' | anova1$type=='challenge_phyworkload_wkover' | anova1$type=='hindrance_phyworkload_wkover'), ]

phyenvir <- anova1[ which(anova1$type=='resources_phyenvironment' | anova1$type=='challenge_phyenvironment' | anova1$type=='hindrance_phyenvironment'), ]

timepress <- anova1[ which(anova1$type=='resources_timepressure' | anova1$type=='challenge_timepressure' | anova1$type=='hindrance_timepressure'), ]

emodemand <- anova1[ which(anova1$type=='resources_emotionaldemands' | anova1$type=='challenge_emotionaldemands' | anova1$type=='hindrance_emotionaldemands'), ]

recipcon <- anova1[ which(anova1$type=='resources_recipientcontact' | anova1$type=='challenge_recipientcontact' | anova1$type=='hindrance_recipientcontact'), ]

workpress <- anova1[ which(anova1$type=='resources_workpressure' | anova1$type=='challenge_workpressure' | anova1$type=='hindrance_workpressure'), ]

report1 <- rstatix::anova_test(data=overwork,dv=score,wid=subject,within=type, effect.size="pes") 
report2 <- rstatix::anova_test(data=phyenvir,dv=score,wid=subject,within=type, effect.size="pes") 
report3 <- rstatix::anova_test(data=timepress,dv=score,wid=subject,within=type, effect.size="pes") 
report4 <- rstatix::anova_test(data=emodemand,dv=score,wid=subject,within=type, effect.size="pes") 
report5 <- rstatix::anova_test(data=recipcon,dv=score,wid=subject,within=type, effect.size="pes") 
report6 <- rstatix::anova_test(data=workpress,dv=score,wid=subject,within=type, effect.size="pes") 

##write.csv(overwork, "checkingANOVAs.csv")

control <- anova1[ which(anova1$type=='resource_jobcontrol' | anova1$type=='challenge_jobcontrol' | anova1$type=='hindrance_jobcontrol'), ]

particip <- anova1[ which(anova1$type=='resource_participation' | anova1$type=='challenge_participation' | anova1$type=='hindrance_participation'), ]

teamcohe <- anova1[ which(anova1$type=='resource_teamcohesion' | anova1$type=='challenge_teamcohesion' | anova1$type=='hindrance_teamcohesion'), ]

autonomy <- anova1[ which(anova1$type=='resource_autonomy' | anova1$type=='challenge_autonomy' | anova1$type=='hindrance_autonomy'), ]

report7 <- rstatix::anova_test(data=control,dv=score,wid=subject,within=type, effect.size="pes") 
report8 <- rstatix::anova_test(data=particip,dv=score,wid=subject,within=type, effect.size="pes") 
report9 <- rstatix::anova_test(data=teamcohe,dv=score,wid=subject,within=type, effect.size="pes") 
report10 <- rstatix::anova_test(data=autonomy,dv=score,wid=subject,within=type, effect.size="pes")

```


```{r modreg, include = FALSE}
# This is pasted from this point below (data object = modreg) from the 
# moderated regression rmd file on 5/21/2024

sigfill <- function(x, sigfigs = 3){
  out <- gsub("\\.$", "",
              formatC(signif(x, digits = sigfigs),
                      digits = sigfigs, format = "fg", flag = "#"))
  out[grepl(".", out, fixed = TRUE)] <- strtrim(out[grepl(".", out, fixed = TRUE)],
                                                sigfigs + c(1, 2)[grepl("-", out, fixed = TRUE) + 1])
  return(out)
}

modreg <- read.csv("SIOPcleaned.csv")      ## from "datacleaning.R" script

## Study 2 DVs

modreg$item387      <- 7- modreg$item387           ## only reflected engagement item

modreg$absorption   <- rowMeans(modreg[c(380:386)], na.rm=TRUE)
modreg$vigor        <- rowMeans(modreg[c(387:392)], na.rm=TRUE) 
modreg$dedication   <- rowMeans(modreg[c(393:399)], na.rm=TRUE) 

modreg$cognitive    <- rowMeans(modreg[c(380:382, 387:388, 393:395)], na.rm=TRUE)
modreg$affective    <- rowMeans(modreg[c(383:384, 389:390, 396:397)], na.rm=TRUE) 
modreg$behavioral   <- rowMeans(modreg[c(385:386, 391:392, 398:399)], na.rm=TRUE) 

######################################################

modreg$burnout      <- rowMeans(modreg[c(373:376)], na.rm=TRUE)
modreg$stress       <- rowMeans(modreg[c(377:379)], na.rm=TRUE)
modreg$engagement   <- rowMeans(modreg[c(380:399)], na.rm=TRUE)        ## added 10/12 because analyses too wonky with 3 subscales

alpha.abs <- psych::alpha(modreg[c(380:386)])
alpha.vig <- psych::alpha(modreg[c(387:392)])
alpha.ded <- psych::alpha(modreg[c(393:399)])
alpha.eng <- psych::alpha(modreg[c(380:399)])

alpha.bur <- psych::alpha(modreg[c(373:376)])
alpha.str <- psych::alpha(modreg[c(377:379)])


## O*NET categories

modreg$onet.resource.ii <- rowMeans(modreg[c(162:166)], na.rm=TRUE)
modreg$onet.resource.mp <- rowMeans(modreg[c(167:176)], na.rm=TRUE)
modreg$onet.resource.wo <- rowMeans(modreg[c(177:185)], na.rm=TRUE)
modreg$onet.resource.io <- rowMeans(modreg[c(186:202)], na.rm=TRUE)
modreg$onet.resource.ir <- rowMeans(modreg[c(149:161)], na.rm=TRUE)
modreg$onet.resource.pc <- rowMeans(modreg[c(128:144,146:148)], na.rm=TRUE)
modreg$onet.resource.sc <- rowMeans(modreg[c(118:127)], na.rm=TRUE)

overall.resource <- rowMeans(modreg[c(118:144,147:202)], na.rm=TRUE)

modreg$onet.hindrance.ii <- rowMeans(modreg[c(246:247,249:252)], na.rm=TRUE)
modreg$onet.hindrance.mp <- rowMeans(modreg[c(252:261)], na.rm=TRUE)
modreg$onet.hindrance.wo <- rowMeans(modreg[c(262:270)], na.rm=TRUE)
modreg$onet.hindrance.io <- rowMeans(modreg[c(271:287)], na.rm=TRUE)
modreg$onet.hindrance.ir <- rowMeans(modreg[c(233:245)], na.rm=TRUE)
modreg$onet.hindrance.pc <- rowMeans(modreg[c(213:232)], na.rm=TRUE)
modreg$onet.hindrance.sc <- rowMeans(modreg[c(203:212)], na.rm=TRUE)

overall.hindrance <- rowMeans(modreg[c(203:247,249:287)], na.rm=TRUE)

modreg$onet.challenge.ii <- rowMeans(modreg[c(332:336)], na.rm=TRUE)
modreg$onet.challenge.mp <- rowMeans(modreg[c(337:346)], na.rm=TRUE)
modreg$onet.challenge.wo <- rowMeans(modreg[c(347:355)], na.rm=TRUE)
modreg$onet.challenge.io <- rowMeans(modreg[c(356:372)], na.rm=TRUE)
modreg$onet.challenge.ir <- rowMeans(modreg[c(319:331)], na.rm=TRUE)
modreg$onet.challenge.pc <- rowMeans(modreg[c(298:307,309:318)], na.rm=TRUE)
modreg$onet.challenge.sc <- rowMeans(modreg[c(288:297)], na.rm=TRUE)

overall.challenge <- rowMeans(modreg[c(288:307,309:372)], na.rm=TRUE)

```
### Challenges, Resources, and Outcomes

```{r AnalyseswithRowSums}
overall.resource <- rowSums(modreg[c(118:144,147:202)], na.rm=TRUE)
#summary(overall.resource) #202.3
overall.hindrance <- rowSums(modreg[c(203:247,249:287)], na.rm=TRUE)
#summary(overall.hindrance) #159.2
overall.challenge <- rowSums(modreg[c(288:307,309:372)], na.rm=TRUE)
#summary(overall.challenge) #204.2

#centered predictors
overall.resource_center <- overall.resource - 202.3
overall.hindrance_center <- overall.hindrance - 159.2
overall.challenge_center <- overall.challenge - 204.2
```

```{r ModeratedRegressionChallenge-ResourceBurnout}

cr_burn_m1 <- lm(burnout ~ scale(overall.challenge), modreg)
#summary(cr_burn_m1)

cr_burn_m2 <- lm(burnout ~ scale(overall.challenge) + scale(overall.resource), modreg)
#summary(cr_burn_m2)

cr_burn_m3 <- lm(burnout ~ scale(overall.challenge) + scale(overall.resource) + scale(overall.challenge*overall.resource), modreg)
#summary(cr_burn_m3)

aov_test <- anova(cr_burn_m2, cr_burn_m3)
#aov_test
```

```{r ModeratedRegressionChallenge-ResourceStress}

cr_stress_m1 <- lm(stress ~ scale(overall.challenge), modreg)
#summary(cr_stress_m1)

cr_stress_m2 <- lm(stress ~ scale(overall.challenge) + scale(overall.resource), modreg)
#summary(cr_stress_m2)

cr_stress_m3 <- lm(stress ~ scale(overall.challenge) + scale(overall.resource) + scale(overall.challenge*overall.resource), modreg)
#summary(cr_stress_m3)

cr_stress_anova <- anova(cr_stress_m2, cr_stress_m3)
#cr_stress_anova
```

```{r Moderated Regression Challenge-ResourceEngagement}

cr_eng_m1 <- lm(engagement ~ scale(overall.challenge), modreg)
#summary(cr_eng_m1)

cr_eng_m2 <- lm(engagement ~ scale(overall.challenge) + scale(overall.resource), modreg)
#summary(cr_eng_m2)

cr_eng_m3 <- lm(engagement ~ scale(overall.challenge) + scale(overall.resource) + scale(overall.challenge*overall.resource), modreg)
#summary(cr_eng_m3)

cr_eng_anova <- anova(cr_eng_m2, cr_eng_m3)
#cr_eng_anova
```

```{r Moderated Regression Hindrance-Resource Burnout}

hr_burn_m1 <- lm(burnout ~ scale(overall.hindrance), modreg)
#summary(hr_burn_m1)

hr_burn_m2 <- lm(burnout ~ scale(overall.hindrance) + scale(overall.resource), modreg)
#summary(hr_burn_m2)

hr_burn_m3 <- lm(burnout ~ scale(overall.hindrance) + scale(overall.resource) + scale(overall.hindrance*overall.resource), modreg)
#summary(hr_burn_m3)

hr_burn_anova <- anova(hr_burn_m2, hr_burn_m3)
#hr_burn_anova
```

```{r ModeratedRegressionHindrance-ResourceStress}

hr_stress_m1 <- lm(stress ~ scale(overall.hindrance), modreg)
#summary(hr_stress_m1)

hr_stress_m2 <- lm(stress ~ scale(overall.hindrance) + scale(overall.resource), modreg)
#summary(hr_stress_m2)

hr_stress_m3 <- lm(stress ~ scale(overall.hindrance) + scale(overall.resource) + scale(overall.hindrance*overall.resource), modreg)
#summary(hr_stress_m3)

hr_stress_anova <- anova(hr_stress_m2, hr_stress_m3)
#hr_stress_anova
```

```{r Moderated Regression Hindrance-Resource Engagement}

hr_eng_m1 <- lm(engagement ~ scale(overall.hindrance), modreg)
#summary(hr_eng_m1)

hr_eng_m2 <- lm(engagement ~ scale(overall.hindrance) + scale(overall.resource), modreg)
#summary(hr_eng_m2)

hr_eng_m3 <- lm(engagement ~ scale(overall.hindrance) + scale(overall.resource) + scale(overall.hindrance*overall.resource), modreg)
#summary(hr_eng_m3)

hr_eng_anova <- anova(hr_eng_m2, hr_eng_m3)
#hr_eng_anova
```

```{r NumbersforTable1}

options(scipen=999)  ## Suppresses scientific notation

#Challenge-Resource-Burnout

# b weights
chal.2.burn <- round(summary(cr_burn_m2)$coefficients[2, 1],2)
res.2.burn <- round(summary(cr_burn_m2)$coefficients[3, 1],2)
chal.3.burn <- round(summary(cr_burn_m3)$coefficients[2, 1],2)
res.3.burn <- round(summary(cr_burn_m3)$coefficients[3, 1],2)
int.cr.3.burn <- round(summary(cr_burn_m3)$coefficients[4, 1],2)

#r squared
cr_burn_m2_r <- summary(cr_burn_m2)$r.squared
cr_burn_m3_r <- summary(cr_burn_m3)$r.squared

## R square change
cr_burn_anova <- anova(cr_burn_m2, cr_burn_m3)
cr_burn_r_square_change <- sigfill(cr_burn_m3_r - cr_burn_m2_r)

#Challenge-Resource-Stress

# b weights
chal.2.stress <- round(summary(cr_stress_m2)$coefficients[2, 1],2)
res.2.stress <- round(summary(cr_stress_m2)$coefficients[3, 1],2)

chal.3.stress <- round(summary(cr_stress_m3)$coefficients[2, 1],2)
res.3.stress <- round(summary(cr_stress_m3)$coefficients[3, 1],2)
int.cr.3.stress <- round(summary(cr_stress_m3)$coefficients[4, 1],2)

#r squared
cr_stress_m2_r <- summary(cr_stress_m2)$r.squared
cr_stress_m3_r <- summary(cr_stress_m3)$r.squared

## R square change
cr_stress_anova <- anova(cr_stress_m2, cr_stress_m3)
cr_stress_r_square_change <- sigfill(cr_stress_m3_r - cr_stress_m2_r)

#Challenge-Resource-Engagement

# b weights
chal.2.eng <- round(summary(cr_eng_m2)$coefficients[2, 1],2)
res.2.eng <- round(summary(cr_eng_m2)$coefficients[3, 1],2)

chal.3.eng <- round(summary(cr_eng_m3)$coefficients[2, 1],2)
res.3.eng <- round(summary(cr_eng_m3)$coefficients[3, 1],2)
int.cr.3.eng <- round(summary(cr_eng_m3)$coefficients[4, 1],2)

#r squared
cr_eng_m2_r <- round(summary(cr_eng_m2)$r.squared,2)
cr_eng_m3_r <- round(summary(cr_eng_m3)$r.squared,2)

## R square change
cr_eng_anova <- anova(cr_eng_m2, cr_eng_m3)
cr_eng_r_square_change <- round(cr_eng_m3_r - cr_eng_m2_r,2)
```

```{r NumbersforTable2}

options(scipen=999)  ## Suppresses scientific notation

#Hindrance-Resource-Burnout

# b weights
hind.2.burn <- round(summary(hr_burn_m2)$coefficients[2, 1],2)
res.2hr.burn <- round(summary(hr_burn_m2)$coefficients[3, 1],2)
hind.3.burn <- round(summary(hr_burn_m3)$coefficients[2, 1],2)
res.3hr.burn <- round(summary(hr_burn_m3)$coefficients[3, 1],2)
int.hr.3.burn <- round(summary(hr_burn_m3)$coefficients[4, 1],2)

#r squared
hr_burn_m2_r <- round(summary(hr_burn_m2)$r.squared,2)
hr_burn_m3_r <- round(summary(hr_burn_m3)$r.squared,2)

## R square change
hr_burn_anova <- anova(hr_burn_m2, hr_burn_m3)
hr_burn_r_square_change <- round(hr_burn_m3_r - hr_burn_m2_r,2)

#Hindrance-Resource-Stress

# b weights
hind.2.stress <- round(summary(hr_stress_m2)$coefficients[2, 1],2)
res.2hr.stress <- round(summary(hr_stress_m2)$coefficients[3, 1],2)

hind.3.stress <- round(summary(hr_stress_m3)$coefficients[2, 1],2)
res.3hr.stress <- round(summary(hr_stress_m3)$coefficients[3, 1],2)
int.hr.3.stress <- round(summary(hr_stress_m3)$coefficients[4, 1],2)

#r squared
hr_stress_m2_r <- round(summary(hr_stress_m2)$r.squared,2)
hr_stress_m3_r <- round(summary(hr_stress_m3)$r.squared,2)

## R square change
hr_stress_anova <- anova(hr_stress_m2, hr_stress_m3)
hr_stress_r_square_change <- round(hr_stress_m3_r - hr_stress_m2_r,2)

#Hindrance-Resource-Engagement

# b weights
hind.2.eng <- round(summary(hr_eng_m2)$coefficients[2, 1],2)
res.2hr.eng <- round(summary(hr_eng_m2)$coefficients[3, 1],2)

hind.3.eng <- round(summary(hr_eng_m3)$coefficients[2, 1],2)
res.3hr.eng <- round(summary(hr_eng_m3)$coefficients[3, 1],2)
int.hr.3.eng <- round(summary(hr_eng_m3)$coefficients[4, 1],2)

#r squared
hr_eng_m2_r <- summary(hr_eng_m2)$r.squared
hr_eng_m3_r <- summary(hr_eng_m3)$r.squared

## R square change
hr_eng_anova <- anova(hr_eng_m2, hr_eng_m3)
hr_eng_r_square_change <- sigfill(hr_eng_m3_r - hr_eng_m2_r)
```

```{r, results='asis', include=FALSE}
#I'm not touching this script - using it as a model and making two new chunks
library(kableExtra)

DV <- c("Burnout","","")
Step <- c("1", "","2")
Model <- c("Challenge", "Resource", "Challenge X Resource")
b <- c(chal.2.burn,res.2.burn,int.cr.3.burn)
DeltaR <- c("",paste(cr_burn_m2_r,"**"),cr_burn_r_square_change)

regtable <- cbind(DV, Step, Model, b, DeltaR)

papaja::apa_table(regtable)

```

```{r chal-resource-table, results='asis'}

library(kableExtra)

DV <- c("Engagement","","","","","Stress","","","","", "Burnout","","","","")
Step <- c("1", "","2", "", "", "1", "","2", "","", "1", "","2", "","")
Model <- c("Challenge", "Resource", "Challenge", "Resource", "Challenge X Resource", "Challenge", "Resource", "Challenge", "Resource", "Challenge X Resource", "Challenge", "Resource", "Challenge", "Resource", "Challenge X Resource")
Beta <- c(sigfill(chal.2.eng), paste(res.2.eng,"**"), chal.3.eng, paste(res.3.eng,"**"), paste(int.cr.3.eng,"*"), chal.2.stress, res.2.stress, chal.3.stress, res.3.stress, int.cr.3.stress, paste(chal.2.burn,"**"), res.2.burn, paste(chal.3.burn,"**"), res.3.burn, int.cr.3.burn)
R2 <- c("", paste(cr_eng_m2_r,"**"), "", "", paste(cr_eng_m3_r,"**"), "", round(cr_stress_m2_r,2), "", "", round(cr_stress_m3_r,2), "", paste(round(cr_burn_m2_r,2),"**"), "", "",paste(round(cr_burn_m3_r,2),"**"))
DeltaR <- c("","","","", paste(cr_eng_r_square_change,"*"), "","","","",cr_stress_r_square_change, "","","","",cr_burn_r_square_change)
regtable <- as.data.frame(cbind(DV, Step, Model, Beta, R2, DeltaR))

colnames(regtable)[4] <- "$\\beta$"
colnames(regtable)[5] <- "$R^2$"
colnames(regtable)[6] <- "$\\Delta R^2$"

papaja::apa_table(regtable, 
              caption = "Moderated regression summary of outcomes regressed on challenges and resources",
              escape=FALSE,
              note="* = p < .05; ** = p < .01, coefficients are unstandardized")
```

```{r}
cr_eng_info2 <- apa_print(cr_eng_m2)
cr_eng_info3 <- apa_print(cr_eng_m3)

cr_stress_info2 <- apa_print(cr_stress_m2)
cr_stress_info3 <- apa_print(cr_stress_m3)

cr_burn_info2 <- apa_print(cr_stress_m2)
cr_burn_info3 <- apa_print(cr_stress_m3)

hr_eng_info2 <- apa_print(hr_eng_m2)
hr_eng_info3 <- apa_print(hr_eng_m3)

hr_stress_info2 <- apa_print(hr_stress_m2)
hr_stress_info3 <- apa_print(hr_stress_m3)

hr_burn_info2 <- apa_print(hr_burn_m2)
hr_burn_info3 <- apa_print(hr_burn_m3)

```

H3a predicted that both resources and challenges would predict engagement. Table \@ref(tab:chal-resource-table) summarizes the results for engagement (as well as stress and burnout). Sum scores for the predictors were used here such that the overall amount of resource or demand is recognized. First, challenges and resources explained a statistically significant amount of the variability in engagement, $R^2$ = `r round(summary(cr_eng_m2)$r.squared, 2)`, Adj. $R^2$ =  `r round(summary(cr_eng_m2)$adj.r.squared, 2)`, `r cr_eng_info2$statistic$modelfit$r2`.  Here, the resource slope is significant, wheras the challenge slope is not significant (providing partial support for H3a). The inclusion of the interaction term in step two of the model contributed a significant addition to the model, `r cr_eng_info3$statistic$modelfit$r2`, $\Delta R^2$ = `r cr_eng_r_square_change`, $\Delta F$ (`r cr_eng_anova$Df[2]`, `r cr_eng_anova$Res.Df[2]`) = `r cr_eng_anova$F[2]`,  and thus provides statistical support for the presence of moderation (Hypothesis 4a). Figure \@ref(fig:chal-resource-int) illustrates the interaction. With low levels of resources, the relationship between challenges and engagement is relatively flat and engagement is comparatively low. With more resources, the relationship between challenges and engagement is negative, but engagement still remains higher with greater reported challenge when more resources are perceived.

Next, challenge demands and resources did not explain a significant amount of the variance in stress,  $R^2$ = `r round(summary(cr_stress_m2)$r.squared, 2)`, Adj. $R^2$ =  `r round(summary(cr_stress_m2)$adj.r.squared, 2)`, `r cr_stress_info2$statistic$modelfit$r2`, failing to provide support for Hypothesis 3b. The inclusion of the interaction term in step two of the model did not contribute a significant addition to the model, `r cr_stress_info3$statistic$modelfit$r2`, $\Delta R^2$ = `r cr_stress_r_square_change`, $\Delta F$ (`r cr_stress_anova$Df[2]`, `r cr_stress_anova$Res.Df[2]`) = `r cr_stress_anova$F[2]`, and thus does not support the presence of moderation.

Finally, challenge demands and resources explained a statistically significant amount of the variability in burnout, $R^2$ = `r round(summary(cr_burn_m2)$r.squared, 2)`, Adj. $R^2$ =  `r round(summary(cr_burn_m2)$adj.r.squared, 2)`, `r cr_burn_info2$statistic$modelfit$r2`. The inclusion of the interaction term in step two of the model did not contribute a significant addition to the model, `r cr_burn_info3$statistic$modelfit$r2`, $\Delta R^2$ = `r cr_burn_r_square_change`, $\Delta F$ (`r cr_burn_anova$Df[2]`, `r cr_burn_anova$Res.Df[2]`) = `r cr_burn_anova$F[2]`,  and thus failing to provide statistical support for the presence of moderation (Hypothesis 4a). In sum, these findings do not provide support for the assertion that resources would moderate the relationships between challenge demands and the outcomes of strain and burnout.

```{r hind-resource-table, results='asis', eval = TRUE}

library(kableExtra)

DV <- c("Engagement","","","","","Stress","","","","", "Burnout","","","","")
Step <- c("1", "","2", "", "", "1", "","2", "","", "1", "","2", "","")
Model <- c("Hindrance", "Resource", "Hindrance", "Resource", "Hindrance X Resource", "Hindrance", "Resource", "Hindrance", "Resource", "Hindrance X Resource", "Hindrance", "Resource", "Hindrance", "Resource", "Hindrance X Resource")
Beta <- c(paste(hind.2.eng,"**"), paste(res.2hr.eng,"**"), paste(sigfill(hind.3.eng),"**"), paste(res.3hr.eng,"**"), int.hr.3.eng, paste(sigfill(hind.2.stress),"*"), paste(res.2hr.stress), paste(hind.3.stress, "**"), paste(sigfill(res.3hr.stress)), paste(int.hr.3.stress,"**"), paste(sigfill(hind.2.burn),"*"), paste(sigfill(res.2hr.burn),"*"), paste(sigfill(hind.3.burn),"*"), paste(res.3hr.burn), paste(int.hr.3.burn,"**"))
R2 <- c("", paste(round(hr_eng_m2_r,2),"**"), "", "", paste(round(hr_eng_m3_r,2),"**"), "", paste(hr_stress_m2_r,"*"), "", "", paste(hr_stress_m3_r, "**"), "", paste(hr_burn_m2_r,"**"), "", "", paste(hr_burn_m3_r,"**"))
#DeltaR <- c("",paste(hr_eng_m2_r,"**"),hr_eng_r_square_change, "",paste(hr_stress_m2_r,"**"),hr_stress_r_square_change, "",paste(hr_burn_m2_r,"**"),hr_burn_r_square_change)
DeltaR <- c("","","","",hr_eng_r_square_change, "","","","",paste(hr_stress_r_square_change,"**"), "","","","",paste(hr_burn_r_square_change, "**"))
regtable <- as.data.frame(cbind(DV, Step, Model, Beta, R2, DeltaR))

colnames(regtable)[4] <- "$\\beta$"
colnames(regtable)[5] <- "$R^2$"
colnames(regtable)[6] <- "$\\Delta R^2$"

#kableExtra::kable(regtable,
#                  format="latex",
#                  escape=FALSE)

papaja::apa_table(regtable,
                 caption = "Moderated regression summary of outcomes regressed on hindrances and resources",
                 escape=FALSE,
                 note="* = p < .05; ** = p < .01, coefficients are unstandardized")
```
### Hindrances, Resources, and Outcomes

We also explored whether there was an interaction between hindrance demands and resources on the outcome variables. Sum scores for the predictors were used here again. First, hindrance demands and resources explained a statistically significant amount of the variability in engagement, $R^2$ = `r round(summary(hr_eng_m2)$r.squared, 2)`, Adj. $R^2$ =  `r round(summary(hr_eng_m2)$adj.r.squared, 2)`, `r hr_eng_info2$statistic$modelfit$r2` [see Table \@ref(tab:hind-resource-table)]. The inclusion of the interaction term in step two of the model did not contribute a significant addition to the model, `r hr_eng_info3$statistic$modelfit$r2`, $\Delta R^2$ = `r hr_eng_r_square_change`, $\Delta F$ (`r hr_eng_anova$Df[2]`, `r hr_eng_anova$Res.Df[2]`) = `r hr_eng_anova$F[2]`. An interaction between hindrances and resources was not found.

Next exploring stress, hindrance demands and resources explained a statistically significant amount of the variability in stress, $R^2$ = `r round(summary(hr_stress_m2)$r.squared, 2)`, Adj. $R^2$ =  `r round(summary(hr_stress_m2)$adj.r.squared, 2)`, `r hr_stress_info2$statistic$modelfit$r2`. The inclusion of the interaction term in step two of the model contributed a significant addition to the model, `r hr_stress_info3$statistic$modelfit$r2`, $\Delta R^2$ = `r hr_stress_r_square_change`, $\Delta F$ (`r hr_stress_anova$Df[2]`, `r hr_stress_anova$Res.Df[2]`) = `r hr_stress_anova$F[2]`, supporting the presence of a moderated effect.  See Figure \@ref(fig:hind-resource-stress-int). As expected, the relationship between hindrance demands and strain becomes weaker as workers perceive more resources.

Similarly, hindrance demands and resources explained a statistically significant amount of the variability in burnout, $R^2$ = `r round(summary(hr_burn_m2)$r.squared, 2)`, Adj. $R^2$ =  `r round(summary(hr_burn_m2)$adj.r.squared, 2)`, `r hr_burn_info2$statistic$modelfit$r2`. The inclusion of the interaction term in step two of the model contributed a significant addition to the model, `r hr_burn_info3$statistic$modelfit$r2`, $\Delta R^2$ = `r hr_burn_r_square_change`, $\Delta F$ (`r hr_burn_anova$Df[2]`, `r hr_burn_anova$Res.Df[2]`) = `r hr_burn_anova$F[2]`, supporting the presence of a moderated effect (see Figure \@ref(fig:hind-resource-burn-int)). As expected, the relationship between hindrance demands and burnout becomes weaker as workers perceive more resources. Summatively these findings provide support for the assertion that resources would moderate the relationships between hindrance demands and the outcomes of strain and burnout.

```{r chal-resource-int, fig.cap="Interaction between Challenge and Resources on Engagement"}
#install.packages("interactions")
library(interactions)

#running it with unstandardized bs here. 
cr_eng_m3u <- lm(engagement ~ overall.challenge + overall.resource + overall.challenge*overall.resource, modreg)
#summary(cr_eng_m3u)

cr_eng_plot <- interact_plot(cr_eng_m3u, pred = overall.challenge, modx = overall.resource, interval = FALSE,
              int.width = 0.8, x.label = "Challenge", legend.main = "Resource", y.label = "Engagement")
cr_eng_plot
```


```{r hind-resource-stress-int, fig.cap="Interaction between Hindrances and Resources on Stress"}
#install.packages("interactions")
library(interactions)

hr_stress_m3u <- lm(stress ~ overall.hindrance + overall.resource + overall.hindrance*overall.resource, modreg)
#summary(hr_stress_m3u)

hr_stress_plot <- interact_plot(hr_stress_m3u, pred = overall.hindrance, modx = overall.resource, interval = FALSE, 
              int.width = 0.8, x.label = "Hindrance", legend.main = "Resource", y.label = "Stress")
hr_stress_plot
```

```{r hind-resource-burn-int, fig.cap="Interaction between Hindrances and Resources on Burnout"}
#install.packages("interactions")
library(interactions)

hr_burn_m3u <- lm(burnout ~ overall.hindrance + overall.resource + overall.hindrance*overall.resource, modreg)
#summary(hr_burn_m3u)

hr_burn_plot <- interact_plot(hr_burn_m3u, pred = overall.hindrance, modx = overall.resource, interval = FALSE, 
              int.width = 0.8, x.label = "Hindrance", legend.main = "Resource", y.label = "Burnout")
hr_burn_plot
```

# Discussion 

The major aims of this paper were to explore whether: 1) there was variability in subjective ratings of job characteristics as resources and demands, 2) some characteristics were more likely to vary across demand and resource, 3) subjective appraisals were differentially related to positive and negative outcomes, and lastly, 4) if resources buffer the relationships between demands (challenge and hindrance) and outcomes. We found that job characteristics were not uniquely categorized as a resource or demand, but rather, some job characteristics were rated highly as both a resource and a demand (particularly challenge demands). The findings broadly revealed that there was relatively more consistency in ratings of resource and challenge characteristics, and far more variability in job characteristics rated as hindrance demands. This finding lends additional evidence to @horan2020review’s conclusion that “...stressors are only challenge or hindrance stressors to the extent that they are perceived as such by employees” (p. 3). While we did not find support for the prediction that different types of demands would be related to stress and burnout, we did find that resources moderated the challenge-engagement relationship, and further, resources moderated the hindrance-stress, and hindrance-burnout relationships (as predicted). 

In addition to the above findings, this paper made several additional important contributions. We utilized a diverse sample of employees across industries who responded to common O\*NET items. While O\*NET provides detailed information about frequency and importance ratings among employees, we begin the process of expanding what we know of job characteristics to ratings of an extensive range of demands and resources. Further, we provide a repository for other researchers with listing of O\*NET demands and resources across activity and context items for the benefit of all future researchers. We also explored not only context and activity holistically, but at a higher level aggregation, which enhances our knowledge of how employees perceive different categories of resources, challenges, and hindrances within different work dimensions, as well as the relationships among them.

## Implications

The findings presented above have implications for both theory and practice. our findings support the related literature suggesting that perceptions of resources and demands, broadly, are not universal - there are individual differences in how employees experience the characteristics of their jobs [@webster2011extending]. This finding aligns quite well with the challenge-hindrance stressor framework, which collectively argue that employees perceive stimuli (i.e., job characteristics) uniquely [@lazarus1984stress], and thus, could appraise them as either a challenge or hindrance to their job performance [@cavanaugh2000empirical]. Further, @cavanaugh2000empirical suggests that challenge demands are typically associated with positive outcomes and hindrance demands are associated with negative outcomes [e.g., @cavanaugh2000empirical], which we partially supported here. 

Our results suggest that what is generally seen as a resource and challenge tends to be agreed upon more so that what is seen a hindrance. In fact, hindrance demands are rated more variably and thus, it may be important to have conversations about job characteristics and expectations at multiple time points after hire. For example, having open conversations with employees regarding their subjective perceptions of characteristics that may be unique in limiting their performance or comfort. Such conversations could happen during an annual performance review. In addition, @lepine2005meta and @podsakoff2007differential encourage organizations to incorporate strain-reducing activities like training and support to offset the negative effects of challenging job demands, which may be associated with increased performance in the short term, but strain when prolonged. The current results suggest that these activities and training sessions would ideally be personalized. 

Resources did predict engagement, and did moderate several of the challenge-outcome, and hindrance-outcome relationships. As such, we provide further evidence of the importance of perceived resources, particularly when a job is high in hindrance demands, as resources acted as a buffer in both instances. It is worth noting that this paper focused on *perceived* resources, challenges, and hindrances. Differences in outcomes depending on whether or not an employee perceives a job characteristic to be a challenge or hindrance have practical implications especially for managers. Helping employees to manage expectations and frame the work is quite likely to shape how activities are appraised (e.g., as a challenge, or as a resource). Of course, in some instances, framing an activity or job context variable as an opportunity or positive aspect of work is unrealistic, and so interventions aimed at supporting employees (e.g., stress interventions) may be necessary.

## Limitations and Future Directions

As with all individual studies, this project was limited in scope, and as such, there are a number of avenues for future study worth exploring. First, although we aggregated to O\*NET groupings, we were also dealing with single-item measures for much our operationalization. Although not ideal psychometrically, this provided a strong linkage to the established O\*NET framework. Related to that, we intentionally worked within the O\*NET database, and in selecting job context and activity items, did not include other types of job characteristics that may be important resources and demands. Therefore, to the extent that O\*NET is not an exhaustive repository, there are existing characteristics that we did not capture. For example, O\*NET also includes styles and values, which we did not sample. Future studies may want to expand to explore these additional aspects of work. 

We also retained the literature-derived definitions of resources, challenges, and hindrances [@demerouti2001job]. Given the high associations observed between ratings of resource and challenge, it is possible that respondents did not distinguish between these definitions as cleanly as we intended. Future investigations may wish to explore the colloquial versus academic phrasing of these questions and how that may impact observed associations between resources and challenges. We also note that effect sizes were small and thus it is important to consider the practical significance when thinking about potential interventions. We encourage future thought on how consideration of resource and demand perceptions might be combined with moderators to reduce employee stress and burnout, as well as enhance engagement. 

Another interesting avenue for future research is to explore these patterns by job type. @kubicek2023all, for instance, found that employee workload was positively related to strain, and that this relationship was stronger for care and social workers compared to other types of employees. This finding suggests that job type may be an important moderator, and worthy of exploration moving forward.

Lastly, there may be some practical utility to pursue training interventions aimed at *how* characteristics are appraised. Perhaps the clinical literature may be informative - for example, within cognitive behavioral therapeutic applications, the way in which situations are appraised can be a mechanism to help battle affective disorders such as depression. Given the current findings, where the same characteristic may be viewed similarly as both a demand and resource, it is possible that framing interventions may ameliorate negative outcomes of demands such as, for example, stress or strain.

## Conclusion  

In sum, this endeavor builds on the challenge-hindrance stressor literature from a unique lens from within a universally accessible framework. We showed that there are far more individual differences in how employees perceive demands and resources than much of our current research suggests. While resources and challenges were more similarly experienced, what is experienced as a hindrance tends to be more variable. We further provide additional evidence highlighting the value of perceived resources in the workplace, as they were demonstrated to moderate both challenge-engagement, and hindrance-stress/hindrance burnout relationships. 

```{r}

r_refs("r-references.bib")

```

# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup
