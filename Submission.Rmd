---
title             : "Job Demands-Resources Model Components through the Lens of O*NET Classifications"
shorttitle        : "O*NET JD-R"

author: 
  - name          : "Alicia Stachowski"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "Menomenie, WI"
    email         : "stachowskia@uwstout.edu"
  - name          : "John Kulas"
    affiliation   : "2"
  - name          : "Renata Garcia Prieto Palacios Roji"
    affiliation   : "3"

affiliation:
  - id            : "1"
    institution   : "University of Wisconsin - Stout"
  - id            : "2"
    institution   : "eRg"
  - id            : "3"
    institution   : "PepsiCo"

abstract: |
  Much of our understanding of job demands and resources rests on the assumption that some aspects and components of one's job are resources and some are demanding. We build on a small but growing literature suggesting that individual differences may matter. The primary aims were to explore 1) whether there is variability in subjective ratings of job characteristics with respect to how much they served as resources and demands, and 2) whether or not there was a match between the literature-implicated resources/demands and subjective ratings of these characteristics. O*NET work characteristics were rated by 568 employed respondents in terms of relevance, perception as a demand, and perception as a resource. The results suggest that job characteristics differ in variability/stability regarding subjective worker perceptions, particularly for hindrance demands which showed the most variability. Job characteristics were not uniquely categorized as a resource or demand as evidenced by correlations, and lastly, literature-implicated resources not consistently rated as job resources or demands.
  
keywords         : "O*Net, challenge-hindrance framework, job demands-resoures, job characteristics"
wordcount        : "X"

bibliography     : ["r-references.bib", "jdr.bib", "jobdemands_resources_bibtex.bib"]

floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no

csl               : apa7.csl
documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}

library("papaja")

```

```{r analysis-preferences}

# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed, echo=FALSE, warning=FALSE, message=FALSE)

```

Research on the job demands-resources model [@demerouti2001job] and later job demands-resources theory [@bakker2017job] highlights the importance of work characteristics on the experience of motivation and strain, which subsequently have an impact on job performance among other outcomes. However, much of our existing knowledge regarding the way this model functions is grounded in the assumption that job characteristics are generally considered resources or generally considered demands. We build on the research of a small, but growing number of researchers who argue that the characteristics of work may be appraised simultaneously as resources and demands [@webster2011extending] or that appraisals may change over time [@rosen2020challenges]. We extend this critical research to that of the subjective distinction between challenge and hindrance demands (and resources) in the workplace, with a primary aims of exploring 1) whether there is variability in subjective ratings of job characteristics with respect to how much they serve as resources and demands, and 2) whether or not there is a match between the literature-implicated resources/demands and subjective ratings of these characteristics. Prior to presenting the current study in detail, we provide a brief overview of the relevant theories and relevant empirical work on this topic. 

## The Job demands-Resources Theory  

The overarching context for this study is that of the job demands-resources theory, which is an expansion of the well-studied job demands-resources model [@demerouti2001job]. One of the major advantages of the job demands-resources theory is that it allows us to model both work environment and job characteristics via job resources and demands. *Resources* include physical, psychological, social, or organizational aspects of the job that may help an employee achieve work goals, reduce job demands, or promote personal growth and development [@demerouti2001job]. In contrast, demands include components of a job that require sustained effort, and as such, produce psychological or physiological strain [e.g., high work pressure is frequently cited as a common demand; @demerouti2001job]. Cognitively, the perception of an element of one’s job as a resource or demand activates one of two distinct processes: either health impairment (resulting from demands) or motivation (resulting from resources) [@bakker2014job]. Of particular importance here is that it is the perception of a characteristic or situation determines which process an employee will experience despite the typical apriori assignment of a characteristic as objectively a "demand" or "resource". We explore this further below.

## The Essential Role of Appraisal  

As described in the last paragraph, job context and characteristics are assigned or appraised as demands or resources. Although much of our research on job demands in particular is based on apriori classifications [@searle2015merits], the classification of a work characteristic as a demand or resource is largely subjective by nature (e.g., an employee could most certainly perceive being a public figure as a resource or as a demand. The stress process speaks to how such individual difference in appraisal is possible. @lazarus1984stress presented the transactional theory of stress and coping, which states that people cognitively appraise stimuli in their environments on a continuous basis. Via this process, meaning is assigned to stimuli based on potential for gain or loss. If appraised as threatening, challenging, or possibly harmful, the resulting emotional distress initiates coping. The cycle of appraisal then continues based on the action to cope with the stressor [@lazarus1984stress]. Coping is considered a secondary appraisal and is the way that someone chooses to manage a stressor. Although not suggested by the names, primary and secondary appraisals can happen simultaneously. For instance, available resources to cope with a stressor may influence an employee’s initial appraisal of a stressor (e.g., amount of time [resource] available to prepare for the speech may influence one’s primary appraisal of this ask). 
  
## The Challenge-hindrance Stressor Framework  

Although there is a tendency to attach a negative connotation to the word “stress”, @selye1936syndrome defined stress as simple a response to change. We return to the employed public figure for this next section. Consider two employees be called upon to serve as spokespeople for their organization. One may appraise the circumstance as an opportunity to positively influence others, while the other may feel daunted by the task. 

The challenge-hindrance stressor framework suggests that the way we understand reactions to stressors requires consideration of how people feel about a given stressor [@cavanaugh2000empirical]. @cavanaugh2000empirical delineated between two forms of demands – that of *challenge* and *hindrance* demands. Challenge demands promote mastery, personal growth, and future gains – these stressors should lead to coping strategies that facilitate achievement. Stressors like time pressure and responsibility are considered challenge stressors/demands. Hindrance demands, in contrast, inhibit growth, learning and goal achievement. Hindrance stressors (e.g., role conflict, role ambiguity, politics) are associated with negative job behaviors and attitudes. This distinction between challenges and hindrances has been of value in determining which demands are related to various outcomes. The original work on this topic suggests that challenge stressors are typically associated with positive outcomes and hindrance stressors are associated with negative outcomes [e.g., @cavanaugh2000empirical]. 

Prior to considering the subsequent empirical work on this topic, it is of value to explore *why* different outcomes are expected with these forms of demands. @lepine2022challenge explain the mechanisms by which demands are related to performance and wellbeing outcomes. Similar to the job-demands resources theory [@bakker2017job], challenge and hindrance demands elicit two different paths or processes. First, challenge stressors typically result in a challenge appraisal, and engagement is likely to happen as a result. Engagement, in turn, is positively related to motivation, performance, growth, and wellbeing. Of note is that this energy may be depleted eventually, leading to strain. Hindrance stressors elicit a different process. Disengagement is likely to result from a hindrance appraisal, which in contrast, negatively impacts motivation, performance, growth and wellbeing. This happens because resources are depleted via frustrations and other affectively negative reactions [@lepine2022challenge]. 
 	
We next consider the empirical evidence on this topic. The first question we should ask is whether people distinguish between challenge vs. hindrance demands, or whether all demands are under a larger “demands” category. Evidence suggests the employees do, in fact, differentiate between challenge and hindrance stressors [e.g., @bakker2013weekly; @gerich2017relevance; @webster2011extending]. For example, @bakker2013weekly found that work pressure was perceived as a hindrance demand, and emotional demands as more of a challenge demand. @webster2011extending approached this question with three common workplace demands: workload, role ambiguity, and role conflict. They found while that each could be appraised primarily as challenges or hindrances demands, they could also simultaneously be perceived as being both a challenge and hindrance demands to different degrees. 

Appraisals are associated with different forms of coping, and subsequently, outcomes. The challenge-hindrance stressor framework has been associated with a wide variety of organizational outcomes ranging from affective variables like job satisfaction, to motivation, performance, and wellbeing. A sampling of variables and relationships are described below to provide a sense of scope of the work that has been on this topic. @kim2020thriving found that appraising a demand (in their study, workload, responsibility, and learning demands were measured) as a challenge was associated with motivational resources (i.e., sense of self-worth and work meaningfulness), which were positively related to flourishing. The opposite occurred when a demand was appraised as a hindrance – in those instances, the appraisal had a negative association with motivational resources. @cavanaugh2000empirical, in a study of managers, found that challenge demands were positively related to job satisfaction and negatively related to job search behaviors, while hindrance demands demonstrated the opposite pattern. @chen2021daily found that daily challenge demands were positively related to cognitive wellbeing and work-family enrichment. Daily hindrance demands were negatively related to these outcomes. In contrast, @abbas2019challenge found that challenge and hindrance stressors were *both* positively related to strain and turnover intentions. We also have some evidence that challenge-hindrance appraisals are related to engagement in the expected direction whereby hindrance appraisals are negatively associated with engagement and challenge appraisals are positively associated with it [@crawford2010linking]. Challenge and hindrance appraisals have also been shown to relate to citizenship and counterproductive performance, although indirectly via emotions like anxiety [@rodell2009can]. Lastly, @gerich2017relevance concluded that employee wellbeing was also, in part, explained by appraised challenge or hindrance demands such that working conditions of time pressure, qualitative demands, responsibility, and interruptions, were partially mediated by challenge and hindrance demands. 

We even have sufficient evidence to explore outcomes associated with challenge and hindrance stressors meta-analytically at this point, and a rich collection of them support differential associations across a variety of organizational outcomes as well. For example, both challenges and hindrances have been shown to positively predict strain [@lepine2005meta; @podsakoff2007differential; @webster2010toward]. Many other outcomes are differentially related to challenges and hindrances, largely in the expected direction. For example, motivation, job satisfaction, commitment, and performance have been shown to positively relate to challenge stressors and negatively relate to hindrance stressor [@lepine2005meta]. Turnover intentions, turnover and withdrawal behaviors are negatively related to hindrance stressors [@podsakoff2007differential]. @kim2020thriving, similarly, found evidence for the differential results via challenge and hindrance appraisals.  

@horan2020review and @lepine2022challenge specifically call out the need for additional research to incorporate the appraisal process described by @lazarus1984stress into the challenge-hindrance stressor framework, which aligns with other calls to capture subjective ratings of demands and resources into our study of the overarching JD-R model. In fact, @horan2020review state that “…stressors are only challenge or hindrance stressors to the extent that they are perceived as such by employees” (p. 3). In fact, @horan2020review suggest future research continue to move away from apriori classifications of stressors, as doing so can be problematic for theoretical and empirical reasons. Theoretically, apriori classifications run counter to the original transactional theory of stress on which the challenge-hindrance stressor framework was based for which appraisals are a central component. Empirically, as shown above, we have some evidence suggesting people can appraise a stressor as both a hindrance and challenge at the same time [e.g., @searle2015merits]. TRANSITION NEEDED HERE. I DELETED THE ONET PARAGRAPH.

## Current Study and Hypotheses

The integration of the literature above results in two primary predictions. The first addresses whether employees generally agree on their appraisals of job characteristics as resources or challenge or hindrance demands. For instance, although challenge stressors tend to be appraised more so as challenges, and hindrance stressors tend to be appraised more as hindrances than challenges, others have reported variability in these appraisals [@lepine2022challenge]. @lepine2022challenge, in fact, argues that the challenge-hindrance stressor framework acknowledges that these appraisals are not universal. Thus, it is quite possible, given the theoretical and empirical evidence presented above, that there is wide variability in individual appraisal of work activities and context such that some people may rate a given activity as a resource and others a hindrance. 

>Hypothesis 1: Job characteristics differ in variability/stability regarding subjective worker perception as a demand or resource.

>Hypothesis 2: Job characteristics are not uniquely categorized as a resource or demand, but rather, some job characteristics are rated highly as both a resource and a demand.

We explore three research questions addressing whether our literature-implicated job characteristics (e.g., autonomy) are consistently rated as our research models suggest across the job-demands resources theory [@bakker2017job] and challenge-hindrance stressor framework [@cavanaugh2000empirical]. 

>*Research Question 1*: Are literature-implicated resources consistently rated as job resources?

>*Research Question 2*: Are literature-implicated demands consistently rated as job demands?

```{r study1}

temp <- read.csv("initial_data_screen.csv", header=FALSE, na.strings="")   ## NOTE: 404 vars (9/28/21) make sure to check indexing used throughout script

x <- paste("item", sep="",1:404)
y <- t(temp[2,])
                                        ## decluttering Qualtrics excess
data <- temp[-c(1:3),]                                           ## Getting rid of all 3 weird Qualtrics rows
colnames(data) <- x

incomplete <- read.csv("inprogress.csv", header=FALSE, na.strings="")   ## NOTE: 404 vars (9/28/21) make sure to check indexing used throughout script

data2 <- incomplete[-c(1:2),-c(10,12,16,113,199,285,371,379,400, 406:411)]                                          

data3 <- as.data.frame(cbind(data2$V8,data2$V9,data2$V1,data2$V1,data2$V1,data2$V1,data2$V1,data2$V1,data2))

colnames(data3) <- x

rm(x, y, temp)       

use <- rbind(data,data3)

## STILL NEED FILE WITH BAD RESPONDENTS IDENTIFIED (E.G., Item_18=2, na > 200, longstring > 20, CARELESS CHECKS > 1)

library(careless)
use$careless_long <- longstring(use[18:399])
use$missing <- rowSums(is.na(use[18:404])) 

different <- use[ which(use$item18 == 2 | use$careless_long > 20 | use$missing > 200), ]

attention <- use[which(use$item61 == 5 & use$item145 == 5 & use$item248 == 2 & use$item308 == 3), ]

data <- data.frame(lapply(attention, function(x) as.numeric(as.character(x))))
data <- data[,c(1:404)]

numtot <- nrow(use)
numkicked <- nrow(different)
numvalid <- nrow(data)

```

```{r demos}

a <- descr::freq(use$item401, plot=FALSE)

use$item402[use$item402 == "Female " | use$item402 == "female" | use$item402 == "FEMALE" | use$item402 == "Woman" | use$item402 == "Mujer" | use$item402 == "feminine" | use$item402 == "fEMALE" | use$item402 == "F" | use$item402 == "Femenale" | use$item402 == "feminino" | use$item402 == "female " | use$item402 == "Fem" | use$item402 == "Feminine" | use$item402 == "feminine" | use$item402 == "WOMAN" | use$item402 == "Femal" | use$item402 == "femenine" | use$item402 == "Femenine" | use$item402 == "femenino" | use$item402 == "woman"]  <- "Female"

use$item402[use$item402 == "gerente" | use$item402 == "M" | use$item402 == "Make" | use$item402 == "Mal" | use$item402 == "male" | use$item402 == "MALE" | use$item402 == "male" | use$item402 == "Male" | use$item402 == "mals" | use$item402 == "man" | use$item402 == "masculine" | use$item402 == "Masculine" | use$item402 == "Man" | use$item402 == "mals " | use$item402 == "male " | use$item402 == "Male "]  <- "Male"

b <- descr::freq(use$item402, plot=FALSE)

##Job title
library(labourR)


#ESCO/ISCO classification using the labourR package
#ISCO = International Standard Classification of Occupations

attention$id <- 1:nrow(attention) #adds unique identifier to satisfy inane requirement of classify_occupation()

ISCO <- classify_occupation(attention, text_col = 'item400', isco_level = 1) 

m3 <-merge(attention, ISCO, by.x = "id", by.y = "id", all.x = TRUE)

c <- descr::freq(m3$preferredLabel, plot=FALSE)

knowledge <- data[ which(m3$iscoGroup == "1" | m3$iscoGroup == "2"), ]
service <- data[ which(m3$iscoGroup == "3" | m3$iscoGroup == "4" | m3$iscoGroup == "5" | m3$iscoGroup == "6" | m3$iscoGroup == "7" | m3$iscoGroup == "8" | m3$iscoGroup == "9"), ]

data$item403[data$item403 == 2000]  <- 20

```


```{r generalrecodes, include=FALSE}

source("recodescript.R", local = knitr::knit_global())

```

# Method
 
Data were collected through Prolific, a data collection platform. An email was sent to a random subset of all eligible participants in the Prolific respondent pool, notifying them about their eligibility for the study based on demographic information. Eligibility requirements included being 18+ and holding either a full-time or part-time job. Participants then voluntarily chose to respond to the survey. The survey was conducted online via Qualtrics with an estimated completion time of 40-45 minutes. Participants were asked to think about their primary job while answering the survey, and the items they were presented with depended on the specific job characteristics they initially specified. Thus, if a respondent indicated that a characteristic was not part of their job, they were not subsequently asked to rate the level of resource, challenge, or hindrance for that characteristic. For characteristics that *were* implicated as being relevent for their job, they were then asked to report how much a characteristic was a resource, and then how much each characteristic was a hindrance, and finally, how much each item was a challenge. Participants were compensated for their participation in this study in the amount of six dollars through Prolific.

## Participants

Of the `r nrow(use)` individuals who initially accessed the survey link, `r nrow(different)` indicated that they were not interested, had more than 200 missing responses, or had 20 or more identical consecutive sequential responses [@R-careless]. Applying a further screen regarding attention checks (there were four attention checks embedded throughout, asking respondents to indicate a specific answer) resulted in the retention of `r nrow(data)` respondents who constitute the current sample. Regarding tenure, `r round(a[1,3],2)`% had been in their referent job less than 6 months, `r round(a[2,3],1)`% between 6 months and a year, `r round(a[3,3],2)`% between one and five years, `r round(a[4,3],2)`% between 5 and 10 years, and `r round(a[5,3],2)`% more than 10 years. Respondent ages ranged from 18 to 65 with an average of `r round(mean(data[,403], na.rm=TRUE),2)` years old (*SD* = `r round(sd(data[,403], na.rm=TRUE),2)`). The survey offered a free-field gender identity category, although the sample predominantly self-identified as female (`r round(b[2,3],2)`%) or male (`r round(b[5,3],2)`%). 

```{r litresources}

###############################################
############################################### include & eval=FALSE on 1/16/23 because of new figure which replaced this older attempt

### ACTUALLY, just commented out the graph because other code chunks needed for subsequent commands - 1/17/23 , fig.cap="Average and standard deviation of O*Net characteristics retained as indicators of Autonomy, Cohesion, Control, Participation, and Supervisor Support."


labels <- read.csv("truncatedlabels.csv", header=FALSE)  ## Changed on 12/19 to fix zero sd issues       

resource <- as.data.frame(t(data[118:202]))           

resource$description <- labels[c(118:202),1]
resource$mean <- round(rowMeans(resource[1:nrow(data)], na.rm=TRUE),2)
resource$sd   <- round(apply(resource[1:nrow(data)], 1, sd, na.rm=TRUE),2)

resource <- resource[-28,]   ## attention check


resource.control <- resource[ which(resource$description=='job structured for you, rather than allowing you to determine tasks, priorities, and goals' | resource$description=='regular work schedules'), ]
resource.control$category <- "Control"

resource.participation <- resource[ which(resource$description=='responsible for work outcomes and results of other workers' | resource$description=='responsibility for the health and safety of others' | resource$description=='developing specific goals and plans to prioritize, organize, and accomplish your work' | resource$description=='scheduling events, programs, and activities, as well as the work of others' | resource$description=='developing, designing, or creating new applications, ideas, relationships, systems, or products' | resource$description=='providing information to supervisors, co-workers, and subordinates by telephone, in written form, e-mail, or in person'), ]
resource.participation$category <- "Participation"

resource.sup.support <- resource[ which(resource$description=='providing guidance and expert advice to management or other groups on technical, systems-, or process-related topics' | resource$description=='identifying the educational needs of others, developing formal educational or training programs or classes, and teaching or instructing others'), ]
resource.sup.support$category <- "Support"

resource.autonomy <- resource[ which(resource$description=='decision making freedom, without supervision'), ]
resource.autonomy$category <- "Autonomy"

resource.cohesion <- resource[ which(resource$description=='work with others in a group or team' | resource$description=='getting members of a group to work together to accomplish tasks' | resource$description=='' | resource$description=='' | resource$description=='' | resource$description=='encouraging and building mutual trust, respect, and cooperation among team members'), ]
resource.cohesion$category <- "Cohesion"

notedresource <- rbind(resource.control, resource.participation, resource.sup.support, resource.autonomy, resource.cohesion)
notedresource$RD <- "Resource"


#########################################################
#########################################################


challenge <- as.data.frame(t(data[288:372]))           

challenge$description <- labels[c(288:372),1]
challenge$mean <- round(rowMeans(challenge[1:nrow(data)], na.rm=TRUE),2)
challenge$sd   <- round(apply(challenge[1:nrow(data)], 1, sd, na.rm=TRUE),2)


challenge <- challenge[-21,]

challenge.control <- challenge[ which(challenge$description=='job structured for you, rather than allowing you to determine tasks, priorities, and goals' | challenge$description=='regular work schedules'), ]
challenge.control$category <- "Control"

challenge.participation <- challenge[ which(challenge$description=='responsible for work outcomes and results of other workers' | challenge$description=='responsibility for the health and safety of others' | challenge$description=='developing specific goals and plans to prioritize, organize, and accomplish your work' | challenge$description=='scheduling events, programs, and activities, as well as the work of others' | challenge$description=='developing, designing, or creating new applications, ideas, relationships, systems, or products' | challenge$description=='providing information to supervisors, co-workers, and subordinates by telephone, in written form, e-mail, or in person'), ]
challenge.participation$category <- "Participation"

challenge.sup.support <- challenge[ which(challenge$description=='providing guidance and expert advice to management or other groups on technical, systems-, or process-related topics' | challenge$description=='identifying the educational needs of others, developing formal educational or training programs or classes, and teaching or instructing others'), ]
challenge.sup.support$category <- "Support"

#challenge.autonomy <- challenge[ which(challenge$description=='decision making freedom, without supervision'), ]
#challenge.autonomy$category <- "Autonomy"

challenge.cohesion <- challenge[ which(challenge$description=='work with others in a group or team' | challenge$description=='getting members of a group to work together to accomplish tasks' | challenge$description=='' | challenge$description=='' | challenge$description=='' | challenge$description=='encouraging and building mutual trust, respect, and cooperation among team members'), ]
challenge.cohesion$category <- "Cohesion"

notedchallenge <- rbind(challenge.control, challenge.participation, challenge.sup.support,  challenge.cohesion)     ## removed challenge.autonomy 8/24/22
notedchallenge$RD <- "Challenge"

############################################################
############################################################


hindrance <- as.data.frame(t(data[203:287]))           

hindrance$description <- labels[c(203:287),1]
hindrance$mean <- round(rowMeans(hindrance[1:nrow(data)], na.rm=TRUE),2)
hindrance$sd   <- round(apply(hindrance[1:nrow(data)], 1, sd, na.rm=TRUE),2)

hindrance <- hindrance[-46,]   ## attention check = 248


hindrance.control <- hindrance[ which(hindrance$description=='job structured for you, rather than allowing you to determine tasks, priorities, and goals' | hindrance$description=='regular work schedules'), ]
hindrance.control$category <- "Control"

hindrance.participation <- hindrance[ which(hindrance$description=='responsible for work outcomes and results of other workers' | hindrance$description=='responsibility for the health and safety of others' | hindrance$description=='developing specific goals and plans to prioritize, organize, and accomplish your work' | hindrance$description=='scheduling events, programs, and activities, as well as the work of others' | hindrance$description=='developing, designing, or creating new applications, ideas, relationships, systems, or products' | hindrance$description=='providing information to supervisors, co-workers, and subordinates by telephone, in written form, e-mail, or in person'), ]
hindrance.participation$category <- "Participation"

hindrance.sup.support <- hindrance[ which(hindrance$description=='providing guidance and expert advice to management or other groups on technical, systems-, or process-related topics' | hindrance$description=='identifying the educational needs of others, developing formal educational or training programs or classes, and teaching or instructing others'), ]
hindrance.sup.support$category <- "Support"

hindrance.autonomy <- hindrance[ which(hindrance$description=='decision making freedom, without supervision'), ]
hindrance.autonomy$category <- "Autonomy"

hindrance.cohesion <- hindrance[ which(hindrance$description=='work with others in a group or team' | hindrance$description=='getting members of a group to work together to accomplish tasks' | hindrance$description=='' | hindrance$description=='' | hindrance$description=='' | hindrance$description=='encouraging and building mutual trust, respect, and cooperation among team members'), ]
hindrance.cohesion$category <- "Cohesion"

notedhindrance <- rbind(hindrance.control, hindrance.participation, hindrance.sup.support, hindrance.autonomy, hindrance.cohesion)
notedhindrance$RD <- "Hindrance"

###########################################################
###########################################################  Name issue somehow above 

labels <- names(notedresource)
colnames(notedchallenge) <- labels
colnames(notedhindrance) <- labels

together <- rbind(notedchallenge,notedhindrance,notedresource)

############################################################
############################################################

library(ggplot2)
library(dplyr)

summarized <- together %>%                               # Summary by group using dplyr
  group_by(category, RD) %>% 
  summarize(mean = mean(mean),
            sd = mean(sd))

summarized$RD <- factor(summarized$RD, levels = c("Resource", "Challenge", "Hindrance"))

#ggplot(summarized, aes(x=category, y=mean, fill=RD)) + geom_bar(stat="identity", position=position_dodge()) + theme_bw() + xlab("") + ylab("Average Job Characteristic Rating") + coord_cartesian(ylim=c(1,5)) + scale_fill_brewer(palette="Blues") + 
#  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.5, size=0.8, position=position_dodge(.9))

```

## Materials

The Occupational Information Network (O\*NET; onetonline.org) contains a comprehensive description of occupations [@peterson2001understanding]. This widely accessed database houses hundreds of standardized and occupation-specific descriptors most occupations in the US and these descriptions are continually updated. We used 98 statements taken from O\*NET [activity and context classifications](https://www.ONETonline.org/find/descriptor/result/4.A.1.b.3). We retained 41 work activity classifications which O\*NET groups into categories of information input (5 statements; Where and how are the information and data gained that are needed to perform this job?), interacting with others (17 statements; What interactions with other persons or supervisory activities occur while performing this job?), mental processes (10 statements; What processing, planning, problem-solving, decision-making, and innovating activities are performed with job-relevant information?) and work output (9 statements; What physical activities are performed, what equipment and vehicles are operated/controlled, and what complex/technical activities are accomplished as job outputs?). Fifty-seven work context statements grouped into interpersonal relationships (14 statements; This category describes the context of the job in terms of human interaction processes), physical work conditions (30 statements; This category describes the work context as it relates to the interactions between the worker and the physical job environment), and structural job characteristics (13 statements; This category involves the relationships or interactions between the worker and the structural characteristics of the job). 

These descriptors often have [unique response categories](https://www.ONETonline.org/find/descriptor/result/4.C.1.c.2). For example, the statement "How responsible is the worker for work outcomes and results of other workers?" has response options ranging from *No responsibility* to *Very high responsibility*, while the statement, "How often do you use electronic mail in this job?" has options ranging from *Never* to *Every day*. The O\*Net descriptors are written in a similar manner to a task statement presented within a job analysis, but the level of abstraction is closer to "responsibility" than task. For example, the descriptor for "level of competition", which is an element of the "structural job characteristics" grouping, is *...to what extent does this job require the worker to compete or to be aware of competitive pressures?* Other than minor grammatical editing (for example, changing “the worker” to “you”), we retained the O\*Net wording for our item stems. We also retained O\*Net’s response scales, several of which were semantically unique across items, but all shared the same 5-point scale. It would likely NOT be considered controversial to referred to these as "effectively" Likert-type response scales. 

We retained the essence of each O\*NET descriptor to capture characteristics of relevance for each respondent. Subsequent to these self evaluations, each respondent who agreed that the element had *at least some relevance* to their job was also asked to rate that element in terms of, 1) ...this aspect of your job is a resource that can be functional in achieving work goals, reduce job demands, or stimulate personal growth/development, 2) ...this aspect of your job is a challenge that can promote mastery, personal growth, or future gains, and 3) ...this aspect of your job is a hindrance that can inhibit personal growth, learning, and work goal attainment.

The total number of items on the survey was less than 392 (98 characteristics x 4 administrations) because we did not ask for demand and resource evaluations for 14 O\*Net characteristics that we projected would have very low frequency of endorsement across respondents (one excluded characteristic, for example, was *...the extent to which the worker is exposed to radiation on the job*). 

# Results  

```{r overallhist, fig.cap="Frequency distribution of standard deviations across characteristics deemed resources, challenges, and demands."}

## resource$sd

toplotresource <- resource
toplotchallenge <- challenge
toplothindrance <- hindrance

toplotresource$RD <- "Resource"
toplotchallenge$RD <- "Challenge"
toplothindrance$RD <- "Hindrance"

toplottogether <- rbind(toplotresource,toplotchallenge,toplothindrance)

library(ggplot2)
#ggplot(resource, aes(x=sd)) + geom_histogram()
ggplot(toplottogether, aes(x=sd)) + geom_histogram() + facet_grid(RD ~ .)

lookie <- stats::bartlett.test(sd ~ RD, toplottogether)

```

The first prediction asks whether job characteristics differ in variability/stability regarding subjective worker perception as a demand or resource. Figure \@ref(fig:overallhist) presents frequency distributions standard deviations of characteristic perceptions, grouped by whether that characteristic was rated as a resource, challenge, or demand. As can be seen in the figure, there was a wide range of agreement versus disagreement with resources and challenges, but hindrances were almost universally associated with disagreement (Bartlett's $K^2$ = `r lookie$statistic[[1]]`, *p* = `r lookie$p.value` ). 

```{r resourcesagree, fig.cap="Characteristics most similarly viewed as resources (lowest standard deviations)."}

sortresource <- resource[order(resource$sd),]

topresource <- head(sortresource, 8)    ## changed for combined plot (1/28/23)

topresource <- topresource[tail(names(topresource),3)]        

library(ggplot2)

a <- ggplot(topresource, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="blue", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Most Agreed Upon as a Resource") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,6)) 

```

```{r challengesagree, fig.cap="Characteristics most similarly viewed as challenges (lowest standard deviations)."}

sortchallenge <- challenge[order(challenge$sd),]

topchallenge <- head(sortchallenge, 8)    ## changed for combined plot (1/28/23)

topchallenge <- topchallenge[tail(names(topchallenge),3)]        

b <- ggplot(topchallenge, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="yellow", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Most Agreed Upon as a Challenge") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,6)) 


```

```{r hindrancesagree, fig.cap="Characteristics most similarly viewed as hindrances (lowest standard deviations)."}

sorthindrance <- hindrance[order(hindrance$sd),]

tophindrance <- head(sorthindrance, 8)  ## changed for combined plot (1/28/23)

tophindrance <- tophindrance[tail(names(tophindrance),3)]        

c <- ggplot(tophindrance, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="red", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Most Agreed upon as a Hindrance") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,6))

## added 2/7/23 for online supplement materials

resourcetemp <- sortresource[,c(569:571)]
challengetemp <- sortchallenge[,c(569:571)]
hindrancetemp <- sorthindrance[,c(569:571)]

write.csv(resourcetemp, "sortresource.csv")
write.csv(challengetemp, "sortchallenge.csv")
write.csv(hindrancetemp, "sorthindrance.csv")

```

Figure \@ref(fig:combinegraphs) presents resources, challenges, and hindrances that are *largely agreed on* as indexed by (relatively) low standard deviations.[^caveat] There are only 8 characteristics presented per perceived category because of limited space. All sortable ratings are available in the online resources.

[^caveat]: There were a few characteristics with standard deviations of "zero" but these were excluded from presentation as they were likely representing only one person (*n*'s should also go on these graphs if they're retained - Alicia's idea 12/2 was to use initial ratings as indicators of counts).

```{r combinegraphs, fig.cap="Characteristics percieved most similarly (lowest standard deviations).", fig.height=10}

library(gridExtra)
grid.arrange(b, c, a, nrow = 3)

```

As can be seen by the graphs, there is considerable disagreement regarding the degree to which job elements are considered *hindrances*, with the 8 elements showing the greatest agreement still ranging in standard deviations from `r min(tophindrance$sd)` to `r max(tophindrance$sd)`. What is widely seen as a resource and challenge tends to be more universally agreed upon (range of lowest 8 resource standard deviations is `r min(topresource$sd)` to `r max(topresource$sd)` and the range of lowest 8 challenge standard deviations is `r min(topchallenge$sd)` to `r max(topchallenge$sd)`.

```{r resourcesdisagree, fig.cap="Characteristics most *dis*similarly viewed as resources (highest standard deviations)."}

resource <- resource[ which(resource$sd > 0), ] 

sortresource <- resource[order(-resource$sd),]

topresource <- head(sortresource, 8)

topresource <- topresource[tail(names(topresource),3)]        

d <- ggplot(topresource, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="blue", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Least Agreed Upon as a Resource") + 
  geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,5)) 

```

```{r challengesdisagree, fig.cap="Characteristics most *dis*similarly viewed as challenges (highest standard deviations)."}

sortchallenge <- challenge[order(-challenge$sd),]

topchallenge <- head(sortchallenge, 8)

topchallenge <- topchallenge[tail(names(topchallenge),3)]        

e <- ggplot(topchallenge, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="yellow", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Least Agreed Upon as a Challenge") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,5)) 


```

```{r hindrancesdisagree, fig.cap="Characteristics most *dis*similarly viewed as hindrances (highest standard deviations)."}


sorthindrance <- hindrance[order(-hindrance$sd),]

tophindrance <- head(sorthindrance, 8)

tophindrance <- tophindrance[tail(names(tophindrance),3)]        

f <- ggplot(tophindrance, aes(x=reorder(description,-sd), y=mean)) + geom_bar(stat="identity", color="red", position=position_dodge()) + theme_bw() +
  scale_x_discrete(labels = function(x) lapply(strwrap(x, width = 60, simplify = FALSE), paste, collapse="\n")) + xlab("") + ylab("Least Agreed upon as a Hindrance") + geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=.2, position=position_dodge(.9)) + coord_flip(ylim=c(1,5))

```

```{r combinegraphs2, fig.cap="Characteristics percieved most *DIS*similarly (lowest standard deviations).", fig.height=10}

library(gridExtra)
grid.arrange(e, f, d, nrow = 3)

```

Figure \@ref(fig:combinegraphs2) presents the resources, challenges, and hindrances that are *largely disagreed on* as indexed by (relatively) high standard deviations (these are the 8 characteristics with the greatest variability in rating). In sum, these results provide some support for H1, particularly for hindrances, which are consistently viewed as "different". 

The second prediction stated that job characteristics would not be uniquely categorized as a resource or demand. Table \@ref(tab:cortab) provides the correlations among the O\*Net item groupings by resource, challenge and hindrance demand. A large proportion of correlations are moderate. Challenge and hindrance demands are smaller in relationship, but mostly negative. Challenge and resource are strongly and positively related. These results provide support for H2 suggesting that there is overlap in how employees perceive job characteristics. Stated another way, job characteristics are not uniquely categorized as a resource or as a demand.

```{r cortab}

data_new <- data

## O*NET categories

data_new$onet.resource.ii <- rowMeans(data_new[c(162:166)], na.rm=TRUE)
data_new$onet.resource.mp <- rowMeans(data_new[c(167:176)], na.rm=TRUE)
data_new$onet.resource.wo <- rowMeans(data_new[c(177:185)], na.rm=TRUE)
data_new$onet.resource.io <- rowMeans(data_new[c(186:202)], na.rm=TRUE)
data_new$onet.resource.ir <- rowMeans(data_new[c(149:161)], na.rm=TRUE)
data_new$onet.resource.pc <- rowMeans(data_new[c(128:144,146:148)], na.rm=TRUE)
data_new$onet.resource.sc <- rowMeans(data_new[c(118:127)], na.rm=TRUE)

data_new$overall.resource <- rowMeans(data_new[c(118:144,146:202)], na.rm=TRUE)

data_new$onet.hindrance.ii <- rowMeans(data_new[c(246:247,249:252)], na.rm=TRUE)
data_new$onet.hindrance.mp <- rowMeans(data_new[c(252:261)], na.rm=TRUE)
data_new$onet.hindrance.wo <- rowMeans(data_new[c(262:270)], na.rm=TRUE)
data_new$onet.hindrance.io <- rowMeans(data_new[c(271:287)], na.rm=TRUE)
data_new$onet.hindrance.ir <- rowMeans(data_new[c(233:245)], na.rm=TRUE)
data_new$onet.hindrance.pc <- rowMeans(data_new[c(213:232)], na.rm=TRUE)
data_new$onet.hindrance.sc <- rowMeans(data_new[c(203:212)], na.rm=TRUE)

data_new$overall.hindrance <- rowMeans(data_new[c(203:247,249:287)], na.rm=TRUE)

data_new$onet.challenge.ii <- rowMeans(data_new[c(332:336)], na.rm=TRUE)
data_new$onet.challenge.mp <- rowMeans(data_new[c(337:346)], na.rm=TRUE)
data_new$onet.challenge.wo <- rowMeans(data_new[c(347:355)], na.rm=TRUE)
data_new$onet.challenge.io <- rowMeans(data_new[c(356:372)], na.rm=TRUE)
data_new$onet.challenge.ir <- rowMeans(data_new[c(319:331)], na.rm=TRUE)
data_new$onet.challenge.pc <- rowMeans(data_new[c(298:307,309:318)], na.rm=TRUE)
data_new$onet.challenge.sc <- rowMeans(data_new[c(288:297)], na.rm=TRUE)

data_new$overall.challenge <- rowMeans(data_new[c(288:307,309:372)], na.rm=TRUE)

data_new$burnout      <- rowMeans(data_new[c(373:376)], na.rm=TRUE)
data_new$stress       <- rowMeans(data_new[c(377:379)], na.rm=TRUE)
data_new$engagement   <- rowMeans(data_new[c(380:399)], na.rm=TRUE)        ## added 10/12 because analyses too wonky with 3 subscales

names(data_new)[names(data_new) == "stress"] <- "Stress"
names(data_new)[names(data_new) == "overall.challenge"] <- "Challenge"
names(data_new)[names(data_new) == "overall.hindrance"] <- "Hindrance"
names(data_new)[names(data_new) == "overall.resource"] <- "Resource"

## Was originally overall: "Challenge", "Hindrance", "Resource"

r <- corx::corx(data_new, x =c("onet.resource.ii", "onet.resource.mp", "onet.resource.wo",  "onet.resource.io", "onet.resource.ir", "onet.resource.pc", "onet.resource.sc", "onet.challenge.ii", "onet.challenge.mp", "onet.challenge.wo",  "onet.challenge.io", "onet.challenge.ir", "onet.challenge.pc", "onet.challenge.sc","onet.hindrance.ii", "onet.hindrance.mp", "onet.hindrance.wo", "onet.hindrance.io", "onet.hindrance.ir", "onet.hindrance.pc", "onet.hindrance.sc"), y =c("onet.resource.ii", "onet.resource.mp", "onet.resource.wo",  "onet.resource.io", "onet.resource.ir", "onet.resource.pc", "onet.resource.sc", "onet.challenge.ii", "onet.challenge.mp", "onet.challenge.wo", "onet.challenge.io", "onet.challenge.ir", "onet.challenge.pc", "onet.challenge.sc","onet.hindrance.ii", "onet.hindrance.mp", "onet.hindrance.wo", "onet.hindrance.io", "onet.hindrance.ir", "onet.hindrance.pc", "onet.hindrance.sc"),            
                triangle = "lower",
                stars = c(0.05, 0.01, 0.001),
                describe = c(`$M$` = mean, `$SD$` = sd))

papaja::apa_table(r$apa, # apa contains the data.frame needed for apa_table,
                  caption = "Challenge, hindrance, and resource bivariate correlations.",
                  escape = FALSE, 
                  font_size = "small", 
                  landscape = TRUE,
                  note = "The seven O*Net grouping categories represented here are: Information Input (ii), Mental Processes (mp), Work Output (wo), Interacting with Others (io), Interpersonal Relationships (ir), Physical Work Conditions (pc), and Structural Job Characteristics (sc)")
```


```{r scalelevelgraphs, fig.cap="Average characteristic rating grouped by literature-implicated categorizations."}

#this is a placeholder for the scale level faceted graph found in plotscript_practice script file. 
#Open the Submission .rmd
#Run chunks up to the source recodes chunk (named, `generalrecodes`), and then use the data object
#to create the ggplot

library(ggplot2)
library(plyr)
library(dplyr)

#Demands (resources ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$resources_workpressure <- rowMeans(subset(data, select = c(item120, item121)), na.rm = TRUE)
data$resources_phyworkload_wkover <- rowMeans(subset(data, select = c(item122, item137, item138,
                                                                      item139, item141, item142,
                                                                      item143)), na.rm = TRUE)
data$resources_timepressure <- rowMeans(subset(data, select = c(item125, item126)), na.rm = TRUE)
data$resources_recipientcontact <- rowMeans(subset(data, select = c(item149, item154, item157, 
                                                                    item160, item186, item188, 
                                                                    item192, item197, item200, 
                                                                    item201, item151)), na.rm = TRUE)
data$resources_phyenvironment <- rowMeans(subset(data, select = c(item128, item129,	item130, item132,
                                                                  item133,item134,	item136,	item144,	item146,
                                                                  item147,	item148,	item177,	item180,
                                                                  item182,	item181,	item183)), na.rm = TRUE)
data$resources_emotionaldemands <- rowMeans(subset(data, select = c(item150, item155, item199)), na.rm = TRUE)

#Demands (challenge ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$challenge_workpressure <- rowMeans(subset(data, select = c(item290, item291)), na.rm = TRUE)
data$challenge_phyworkload_wkover <- rowMeans(subset(data, select = c(item292, item307, 
                                                                      item309, item310,	item312,
                                                                      item313,	item314)), na.rm = TRUE)
data$challenge_timepressure <- rowMeans(subset(data, select = c(item295, item296)), na.rm = TRUE)
data$challenge_recipientcontact <- rowMeans(subset(data, select = c(item319, item324, item327,
                                                                    item330, item356, item358,
                                                                    item362, item367, item370,
                                                                    item371, item321)), na.rm = TRUE)
data$challenge_phyenvironment <- rowMeans(subset(data, select = c(item298, item299, item300, item302,
                                                                  item303, item304,item306, item315, item316,
                                                                  item317, item318, item347, item350,
                                                                  item352, item351, item353)), na.rm = TRUE)
data$challenge_emotionaldemands <- rowMeans(subset(data, select = c(item320, item325, item369)), na.rm = TRUE)

#Demands (hindrance ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$hindrance_workpressure <- rowMeans(subset(data, select = c(item205, item206)), na.rm = TRUE)
data$hindrance_phyworkload_wkover <- rowMeans(subset(data, select = c(item207, item222,item223,
                                                                      item224, item226, item227,
                                                                      item228)), na.rm = TRUE)
data$hindrance_timepressure <- rowMeans(subset(data, select = c(item210, item211)), na.rm = TRUE)
data$hindrance_recipientcontact <- rowMeans(subset(data, select = c(item233, item238, item241, 
                                                                    item244, item271, item273,
                                                                    item277,	item282,	item285,
                                                                    item286, item235)), na.rm = TRUE)
data$hindrance_phyenvironment <- rowMeans(subset(data, select = c(item213, item214, item215, item217,
                                                                  item218, item219, item221, item229,
                                                                  item230,	item231,	item232,	
                                                                  item262, item265, item267, item266,
                                                                  item286)), na.rm = TRUE)
data$hindrance_emotionaldemands <- rowMeans(subset(data, select = c(item234, item239, item284)), na.rm = TRUE)

#Resources (resource ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$resource_jobcontrol <- rowMeans(subset(data, select = c(item124, item127)), na.rm = TRUE)
data$resource_participation <- rowMeans(subset(data, select = c(item158, item159,
                                                                item172,	item174, item175,
                                                                item189, item193, item202)), na.rm = TRUE)
data$resource_teamcohesion <- rowMeans(subset(data, select = c(item161, item190, item191)), na.rm = TRUE)
data$resource_autonomy <- rowMeans(subset(data, select = c(item118, item172)), na.rm = TRUE)

#Resources (challenge ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$challenge_jobcontrol <- rowMeans(subset(data, select = c(item294, item297)), na.rm = TRUE)
data$challenge_participation <- rowMeans(subset(data, select = c(item328, item329, item342,
                                                                 item344, item345, item359, item363,
                                                                 item372)), na.rm = TRUE)
data$challenge_teamcohesion <- rowMeans(subset(data, select = c(item331, item360, item361)), na.rm = TRUE)
data$challenge_autonomy <- rowMeans(subset(data, select = c(item288, item342)), na.rm = TRUE)

#Resources (hindrance ratings)
#These are the literature-based categories, and composites - means - of Onet item ratings
data$hindrance_jobcontrol <- rowMeans(subset(data, select = c(item209, item212)), na.rm = TRUE)
data$hindrance_participation <- rowMeans(subset(data, select = c(item242, item243, item257,	item259,
                                                                 item260,	item274,	item278,
                                                                 item287)), na.rm = TRUE)
data$hindrance_teamcohesion <- rowMeans(subset(data, select = c(item245, item275, item276)), na.rm = TRUE)
data$hindrance_autonomy <- rowMeans(subset(data, select = c(item203, item257)), na.rm = TRUE)

#check the autonomy variables
#summary(data$hindrance_autonomy)
#summary(data$challenge_autonomy)
#summary(data$resource_autonomy)

library(tidyr)

toplot <- gather(data, scale, value, resources_workpressure:hindrance_autonomy, factor_key=TRUE)

library(stringr)
toplot$type <- str_sub(toplot$scale, 1,6)
toplot$onet <- str_sub(toplot$scale, 10,-1)

toplot$type[toplot$type == "challe"] <- "Challenge"
toplot$type[toplot$type == "hindra"] <- "Hindrance"
toplot$type[toplot$type == "resour"] <- "Resource"       ## change `onet` later if want to keep graphs

toplot$onet[toplot$onet == "teamcohesion"] <- "Team Cohesion"       
toplot$onet[toplot$onet == "_teamcohesion"] <- "Team Cohesion"  
toplot$onet[toplot$onet == "participation"] <- "Participation"       
toplot$onet[toplot$onet == "_participation"] <- "Participation"  
toplot$onet[toplot$onet == "jobcontrol"] <- "Job Control"       
toplot$onet[toplot$onet == "_jobcontrol"] <- "Job Control"  
toplot$onet[toplot$onet == "autonomy"] <- "Autonomy"       
toplot$onet[toplot$onet == "_autonomy"] <- "Autonomy"  

toplot$onet[toplot$onet == "_emotionaldemands"] <- "Emotional Demands"          ## added 11/18/22 (Hudson)  
toplot$onet[toplot$onet == "_phyenvironment"] <- "Physical Environment"  
toplot$onet[toplot$onet == "_phyworkload_wkover"] <- "Overwork"  
toplot$onet[toplot$onet == "_recipientcontact"] <- "Recipient Contact"  
toplot$onet[toplot$onet == "_timepressure"] <- "Time Pressure"  
toplot$onet[toplot$onet == "_workpressure"] <- "Work Pressure"  

toplotgg <- ddply(toplot, c("type", "onet"), summarise, average = mean(value, na.rm=TRUE))

#table(toplot$onet)

## Probably want to change this to a facet: 3 different grids grouped by literature-described 1) resource, 2) hindrances, and 3) challenge

toplotgg$facet <- c("Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand",
                    "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand",
                    "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand", "Lit Resource", "Lit Demand", "Lit Demand")


##############################################################
##############################################################
################    Plots

demandsplot <- filter(toplotgg, facet == "Lit Demand")
resourcesplot <- filter(toplotgg, facet == "Lit Resource")


## Demands

demandsplot$onet <- factor(demandsplot$onet, levels=c("Work Pressure", "Recipient Contact", "Emotional Demands", "Time Pressure", "Physical Environment", "Overwork"))

a <- ggplot(data=demandsplot, aes(x=onet, y=average, fill=type)) + 
  geom_bar(stat="identity", position=position_dodge(), color="black") + coord_flip(ylim=c(1,5)) + scale_fill_manual(values=c("#000000","#cccccc","#ffffff")) +
  scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
  theme(legend.title=element_blank(), legend.position="none",  panel.border = element_rect(colour = "black", fill=NA, size=.5), axis.title.x = element_blank(), axis.title.y = element_blank())

## Resources

resourcesplot$onet <- factor(resourcesplot$onet, levels=c("Team Cohesion", "Autonomy", "Participation", "Job Control"))

b <- ggplot(data=resourcesplot, aes(x=onet, y=average, fill=type)) + 
  geom_bar(stat="identity", position=position_dodge(), color="black") + coord_flip(ylim=c(1,5)) + scale_fill_manual(values=c("#000000","#cccccc","#ffffff")) +
  scale_x_discrete(labels=function(x){sub("\\s", "\n", x)}) +
  theme(legend.title=element_blank(), legend.position="bottom",  panel.border = element_rect(colour = "black", fill=NA, size=.5), axis.title.x = element_blank(), axis.title.y = element_blank())

################################################################
################################################################
################################################################

library("gridExtra")
grid.arrange(a, b, ncol = 2, nrow = 1)


```

In addition to the two predictions, three related research questions were proposed. To answer these research questions, authors first categorized items into the categories listed in the JD-R literature. For example, autonomy is frequently described as a resource. An O\*Net item in the autonomy category is, “How much decision making freedom, without supervision, does your job offer?”. Means for resources, challenges, and hindrances groupings were then computed to explore whether literature-implicated resources and demands were consistently rated as such. The left side of Figure 4 shows literature-derived demand categories (e.g., work pressure). Here, we do not see a clear pattern of high ratings as hindrances for these demands. In alignment with what we observed regarding variability in ratings of hindrance stressors in H1, there is much more variability in how employees rated what should objectively be "hindrances" at work. However, in contrast, there is a clearer pattern of the highest level ratings being that of resources on the right side of Figure 4 showing literature-derived resources (e.g., job control) and the corresponding average category ratings. The white bars representing resources are consistently higher. ADD ANOVAS HERE - one way repeated measures for each category (total of 10 analyses). describe pattern. In sum, these results provide ___ support for RQ 1 and 2. 

see Figure \@ref(fig:scalelevelgraphs)

```{r ANOVAs}

library(tidyr)

foranova <- data
foranova$subject <- 1:nrow(foranova) 
  
anova1 <- gather(foranova,type,score,resources_workpressure:hindrance_autonomy, factor_key=TRUE)

## now need to isolate rows with targeted characteristics

overwork <- anova1[ which(anova1$type=='resources_phyworkload_wkover' | anova1$type=='challenge_phyworkload_wkover' | anova1$type=='hindrance_phyworkload_wkover'), ]

phyenvir <- anova1[ which(anova1$type=='resources_phyenvironment' | anova1$type=='challenge_phyenvironment' | anova1$type=='hindrance_phyenvironment'), ]

timepress <- anova1[ which(anova1$type=='resources_timepressure' | anova1$type=='challenge_timepressure' | anova1$type=='hindrance_timepressure'), ]

emodemand <- anova1[ which(anova1$type=='resources_emotionaldemands' | anova1$type=='challenge_emotionaldemands' | anova1$type=='hindrance_emotionaldemands'), ]

recipcon <- anova1[ which(anova1$type=='resources_recipientcontact' | anova1$type=='challenge_recipientcontact' | anova1$type=='hindrance_recipientcontact'), ]

workpress <- anova1[ which(anova1$type=='resources_workpressure' | anova1$type=='challenge_workpressure' | anova1$type=='hindrance_workpressure'), ]

report1 <- rstatix::anova_test(data=overwork,dv=score,wid=subject,within=type, effect.size="pes") 
report2 <- rstatix::anova_test(data=phyenvir,dv=score,wid=subject,within=type, effect.size="pes") 
report3 <- rstatix::anova_test(data=timepress,dv=score,wid=subject,within=type, effect.size="pes") 
report4 <- rstatix::anova_test(data=emodemand,dv=score,wid=subject,within=type, effect.size="pes") 
report5 <- rstatix::anova_test(data=recipcon,dv=score,wid=subject,within=type, effect.size="pes") 
report6 <- rstatix::anova_test(data=workpress,dv=score,wid=subject,within=type, effect.size="pes") 

##write.csv(overwork, "checkingANOVAs.csv")

control <- anova1[ which(anova1$type=='resource_jobcontrol' | anova1$type=='challenge_jobcontrol' | anova1$type=='hindrance_jobcontrol'), ]

particip <- anova1[ which(anova1$type=='resource_participation' | anova1$type=='challenge_participation' | anova1$type=='hindrance_participation'), ]

teamcohe <- anova1[ which(anova1$type=='resource_teamcohesion' | anova1$type=='challenge_teamcohesion' | anova1$type=='hindrance_teamcohesion'), ]

autonomy <- anova1[ which(anova1$type=='resource_autonomy' | anova1$type=='challenge_autonomy' | anova1$type=='hindrance_autonomy'), ]

report7 <- rstatix::anova_test(data=control,dv=score,wid=subject,within=type, effect.size="pes") 
report8 <- rstatix::anova_test(data=particip,dv=score,wid=subject,within=type, effect.size="pes") 
report9 <- rstatix::anova_test(data=teamcohe,dv=score,wid=subject,within=type, effect.size="pes") 
report10 <- rstatix::anova_test(data=autonomy,dv=score,wid=subject,within=type, effect.size="pes")

```

Separate repeated-measures ANOVAs were conducted for each of these comparisons. 

## Literature-implicated demands

Repeated-measures ANOVAs were run for the group of literture-implicated demands first.  The effect for `Overwork` was $F_{(`r report1$ANOVA$DFn`, `r report1$ANOVA$DFd`)}$ = `r report1$ANOVA$F`, partial eta squared $(\eta^2)$ was `r report1$ANOVA$pes`.
The effect for `Physical Environment` was $F_{(`r report2$ANOVA$DFn`, `r report2$ANOVA$DFd`)}$ = `r report2$ANOVA$F` ($\eta^2$ = `r report2$ANOVA$pes`).
The effect for `Time Pressure` was $F_{(`r report3$ANOVA$DFn`, `r report3$ANOVA$DFd`)}$ = `r report3$ANOVA$F` ($\eta^2$ = `r report3$ANOVA$pes`).
The effect for `Emotional Demands` was $F_{(`r report4$ANOVA$DFn`, `r report4$ANOVA$DFd`)}$ = `r report4$ANOVA$F` ($\eta^2$ = `r report4$ANOVA$pes`).
The effect for `Recipient Contact` was $F_{(`r report5$ANOVA$DFn`, `r report5$ANOVA$DFd`)}$ = `r report5$ANOVA$F` ($\eta^2$ = `r report5$ANOVA$pes`).
The effect for `Work Pressure` was $F_{(`r report6$ANOVA$DFn`, `r report6$ANOVA$DFd`)}$ = `r report6$ANOVA$F` ($\eta^2$ = `r report6$ANOVA$pes`).In all cases, statistical significance was less then .001, indicating in all cases, what the literature implicates is a demand was rated as a resource (all means are above the midpoint). See the patten of white resource bars on the lefthand side of Figure 4. This is contrary to the expectation that ratings would match our assumption of what a resource constitutes. Looking at demands, there is a large difference between whether a characteristic is viewed as a challenge or hindrance.

## Literature-implicated resources

Next, Repeated-measures ANOVAs were run for the group of literture-implicated resources (the right hand set of analyses presented in Figure 4). The effect for `Job Control` was $F_{(`r report7$ANOVA$DFn`, `r report7$ANOVA$DFd`)}$ = `r report7$ANOVA$F` ($\eta^2$ = `r report7$ANOVA$pes`).
The effect for `Participation` was $F_{(`r report8$ANOVA$DFn`, `r report8$ANOVA$DFd`)}$ = `r report8$ANOVA$F` ($\eta^2$ = `r report8$ANOVA$pes`).
The effect for `Autonomy` was $F_{(`r report9$ANOVA$DFn`, `r report9$ANOVA$DFd`)}$ = `r report9$ANOVA$F` ($\eta^2$ = `r report9$ANOVA$pes`).
The effect for `Team Cohesion` was $F_{(`r report10$ANOVA$DFn`, `r report10$ANOVA$DFd`)}$ = `r report10$ANOVA$F` ($\eta^2$ = `r report10$ANOVA$pes`).Similar to the demands analyses, statistical significance was less then .001 for all four category comparisons. Here, the pattern was as expected. Across categories, resources were rated the highest (see white bars representing resources in Figure 4).

\newpage

NOTE: Add a table of the items (probably the full list and those we included in challenge, hindrance specifically). Could also have a column showing which items were used for Figure 4 categories. 

# Discussion

The major aim and contribution of this paper was to examine whether there was variability in subjective ratings of job characteristics with respect to how much they serve as resources and demands (both challenge and hindrance), and also whether or not there is a match between the literature-implicated resources/demands and subjective ratings of these characteristics using a sample of items from O*Net. The findings broadly revealed that there was relatively more consistency in ratings of resources and challenges characteristics, and far more variability in job characteristics rated as hindrance stressors. This finding lends additional evidence to Horan et al.’s (2020) conclusion that “...stressors are only challenge or hindrance stressors to the extent that they are perceived as such by employees” (p. 3). The research questions regarding the match between literature-implicated demand and resource categories and empirical ratings aligns with the consistency/variability we observed in H1. Interestingly, we consistently observed that job characteristics rated as resources were also rated highly as challenge stressors, which are not inherently negative in the way that hindrance stressors are. Lastly, we also found support for the prediction that job characteristics are not uniquely categorized as a resource or demand, but rather, some job  characteristics are rated highly as both a resource and a demand (H2).

# Implications

Theoretically, these findings support growing body of literature suggesting that perceptions of resources and demands, broadly, are not universal. There is individual difference in how employees experience the characteristics of their jobs. Much of our existing research on job demands and resources has been done from the perspective that job characteristics could be classified in advance as a “resource” or “demand”. 
These results have implications for managers as well. The reality that there is more individual difference in what employees perceive to be a hindrance and less in what is perceived to be a resource or challenge stressor is in some ways encouraging. These findings provide comforting support for the idea that managers and supervisors can predict which characteristics are perceived as supportive to employees’ performance. Somewhat surprisingly, hindrances are rated more variably. As such, one important implication is that of frequent communication with employees regarding their perceptions of characteristics that limit their performance. @lepine2005meta and @podsakoff2007differential encourage organizations to incorporate strain-reducing activities like train and support to offset the negative effects of challenging job demands.

# Limitations and Future Directions

As with all individual studies, this project was limited in scope, and as such, there are a number of avenues for future study worth exploring here. First, we captured only a small number of job characteristics given the nature of our research questions. Because we asked up to four questions about each characteristics, we were limited in the number of job characteristics we could reasonably include. Related to that, we intentionally worked within the O*Net database, and in selecting job context and activity items, did not include other types of job characteristics that may be important resources/demands. For example, we included minimal “social” resources or interactions with one’s supervisor, which the literature would suggest are important resources. Future study should explore this aspect of work. We also used the exact definitions of resource, challenge, and hindrance. It is possible that respondents did not distinguish between the challenge and resource definition as cleanly as we intended and so future research should explore this question differently. It would also be interesting to consider outcomes associated with subjective ratings. 
Lastly, there may be some practical utility to pursue training interventions aimed at *how* characteristics are appraised. Perhaps the clinical literature may be informative - for example, within cognitive behavioral therapeutic applications, the way in which situations are appraised can be a mechanism to help battle affective disorders such as depression.[^check] Given the current findings, where the same characteristic may be viewed similarly as both a demand and resource, it is possible that framing interventions may ameliorate negative outcomes of demands such as, for example, stress or strain.

# Conclusion

In sum, this endeavor explored the job-demands-resources literature from a unique lens, showing that there are far more individual differences in how employees perceive demands and resources than much of our current research suggests. While resources and challenges are more similarly experienced, hindrance demands show a wide amount of variability. 

```{r}

r_refs("r-references.bib")

```

\newpage

# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup
